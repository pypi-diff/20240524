# Comparing `tmp/nsanic-2024.5.16-py3-none-any.whl.zip` & `tmp/nsanic-2024.5.24-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,8 +1,8 @@
-Zip file size: 59323 bytes, number of entries: 42
+Zip file size: 59361 bytes, number of entries: 42
 -rw-rw-rw-  2.0 fat        0 b- defN 24-Mar-19 13:56 nsanic/__init__.py
 -rw-rw-rw-  2.0 fat     3462 b- defN 24-May-16 07:52 nsanic/base_blue.py
 -rw-rw-rw-  2.0 fat     8536 b- defN 24-May-16 07:52 nsanic/base_conf.py
 -rw-rw-rw-  2.0 fat     3241 b- defN 24-May-16 07:52 nsanic/base_server.py
 -rw-rw-rw-  2.0 fat     9666 b- defN 24-May-16 07:52 nsanic/base_ws.py
 -rw-rw-rw-  2.0 fat     2908 b- defN 24-May-16 07:52 nsanic/exception.py
 -rw-rw-rw-  2.0 fat     7677 b- defN 24-May-16 07:52 nsanic/handler_http.py
@@ -15,30 +15,30 @@
 -rw-rw-rw-  2.0 fat     1276 b- defN 24-May-16 07:52 nsanic/libs/component.py
 -rw-rw-rw-  2.0 fat     3151 b- defN 24-Apr-28 08:45 nsanic/libs/consts.py
 -rw-rw-rw-  2.0 fat     1578 b- defN 24-Mar-21 14:40 nsanic/libs/crypto.py
 -rw-rw-rw-  2.0 fat     3171 b- defN 24-May-16 07:52 nsanic/libs/decorator.py
 -rw-rw-rw-  2.0 fat     1125 b- defN 24-Mar-21 14:40 nsanic/libs/file_type.py
 -rw-rw-rw-  2.0 fat     2728 b- defN 24-May-10 03:09 nsanic/libs/manager.py
 -rw-rw-rw-  2.0 fat     2495 b- defN 24-Mar-21 14:40 nsanic/libs/mult_log.py
--rw-rw-rw-  2.0 fat     5263 b- defN 24-May-16 07:52 nsanic/libs/random_maker.py
--rw-rw-rw-  2.0 fat     8705 b- defN 24-May-16 07:52 nsanic/libs/rds_client.py
+-rw-rw-rw-  2.0 fat     5417 b- defN 24-May-24 03:41 nsanic/libs/random_maker.py
+-rw-rw-rw-  2.0 fat     8937 b- defN 24-May-24 03:41 nsanic/libs/rds_client.py
 -rw-rw-rw-  2.0 fat     1116 b- defN 24-May-16 07:52 nsanic/libs/rds_locker.py
 -rw-rw-rw-  2.0 fat     6985 b- defN 24-Apr-28 09:19 nsanic/libs/tool.py
 -rw-rw-rw-  2.0 fat     5014 b- defN 24-May-16 07:52 nsanic/libs/tool_dt.py
 -rw-rw-rw-  2.0 fat     3070 b- defN 24-May-16 07:52 nsanic/libs/tool_jwt.py
 -rw-rw-rw-  2.0 fat     1956 b- defN 24-May-16 07:52 nsanic/libs/tool_ws.py
 -rw-rw-rw-  2.0 fat        0 b- defN 24-Mar-20 12:48 nsanic/orm/__init__.py
 -rw-rw-rw-  2.0 fat      730 b- defN 24-Mar-19 13:56 nsanic/orm/db_index.py
 -rw-rw-rw-  2.0 fat    18726 b- defN 24-May-16 07:52 nsanic/orm/db_model.py
 -rw-rw-rw-  2.0 fat    11698 b- defN 24-Apr-03 07:45 nsanic/orm/mssql_generator.py
 -rw-rw-rw-  2.0 fat    11743 b- defN 24-Apr-28 08:44 nsanic/orm/mysql_generator.py
 -rw-rw-rw-  2.0 fat    11720 b- defN 24-Apr-03 07:45 nsanic/orm/pgsql_generator.py
 -rw-rw-rw-  2.0 fat     5037 b- defN 24-May-16 07:52 nsanic/orm/rc_model.py
 -rw-rw-rw-  2.0 fat        0 b- defN 24-Mar-19 13:56 test/__init__.py
 -rw-rw-rw-  2.0 fat      701 b- defN 24-May-16 07:52 test/test_unit.py
--rw-rw-rw-  2.0 fat     1090 b- defN 24-May-16 07:57 nsanic-2024.5.16.dist-info/LICENSE
--rw-rw-rw-  2.0 fat     4803 b- defN 24-May-16 07:57 nsanic-2024.5.16.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 24-May-16 07:57 nsanic-2024.5.16.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       52 b- defN 24-May-16 07:57 nsanic-2024.5.16.dist-info/entry_points.txt
--rw-rw-rw-  2.0 fat       12 b- defN 24-May-16 07:57 nsanic-2024.5.16.dist-info/top_level.txt
--rw-rw-r--  2.0 fat     3332 b- defN 24-May-16 07:57 nsanic-2024.5.16.dist-info/RECORD
-42 files, 182701 bytes uncompressed, 54093 bytes compressed:  70.4%
+-rw-rw-rw-  2.0 fat     1090 b- defN 24-May-24 03:42 nsanic-2024.5.24.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat     4803 b- defN 24-May-24 03:42 nsanic-2024.5.24.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 24-May-24 03:42 nsanic-2024.5.24.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       52 b- defN 24-May-24 03:42 nsanic-2024.5.24.dist-info/entry_points.txt
+-rw-rw-rw-  2.0 fat       12 b- defN 24-May-24 03:42 nsanic-2024.5.24.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     3332 b- defN 24-May-24 03:42 nsanic-2024.5.24.dist-info/RECORD
+42 files, 183087 bytes uncompressed, 54131 bytes compressed:  70.4%
```

## zipnote {}

```diff
@@ -102,26 +102,26 @@
 
 Filename: test/__init__.py
 Comment: 
 
 Filename: test/test_unit.py
 Comment: 
 
-Filename: nsanic-2024.5.16.dist-info/LICENSE
+Filename: nsanic-2024.5.24.dist-info/LICENSE
 Comment: 
 
-Filename: nsanic-2024.5.16.dist-info/METADATA
+Filename: nsanic-2024.5.24.dist-info/METADATA
 Comment: 
 
-Filename: nsanic-2024.5.16.dist-info/WHEEL
+Filename: nsanic-2024.5.24.dist-info/WHEEL
 Comment: 
 
-Filename: nsanic-2024.5.16.dist-info/entry_points.txt
+Filename: nsanic-2024.5.24.dist-info/entry_points.txt
 Comment: 
 
-Filename: nsanic-2024.5.16.dist-info/top_level.txt
+Filename: nsanic-2024.5.24.dist-info/top_level.txt
 Comment: 
 
-Filename: nsanic-2024.5.16.dist-info/RECORD
+Filename: nsanic-2024.5.24.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## nsanic/libs/random_maker.py

```diff
@@ -111,16 +111,18 @@
 
     @staticmethod
     def mk_num(length=5):
         """(允许重复)取指定数量级范围内的随机数"""
         return random.randint(10 ** (length - 1), 10 ** length - 1)
 
     @staticmethod
-    def mk_str(length: int = 16):
+    def mk_str(length: int = 16, use_caps=False):
         """随机字符串 默认16位"""
+        if use_caps:
+            return ''.join(random.sample(string.ascii_lowercase + string.ascii_uppercase + string.digits, length))
         return ''.join(random.sample(string.ascii_lowercase + string.digits, length))
 
     @staticmethod
     def mk_arr_one(item_list: (list, tuple), weights: (list, tuple) = None):
         """list随机筛选某项, 带权重的话权重配置长度必须等于列表或元组长度"""
         if item_list and isinstance(item_list, list or tuple):
             if weights and (len(item_list) != len(weights)):
```

## nsanic/libs/rds_client.py

```diff
@@ -62,16 +62,22 @@
             self.log_err('当前redis服务未正常连接')
             raise RdsError()
         return Redis(connection_pool=self.__pool)
 
     @property
     def conn(self):
         return self.__conn
+    
+    async def locked(self, key: str, fun=None, fun_param: (list, tuple) = None, time_out=5):
+        if not fun_param:
+            fun_param = ()
+        async with self.__conn.lock(key, lock_class=RdsLocker, timeout=time_out):
+            return callable(fun) and ((await fun(*fun_param)) if asyncio.iscoroutinefunction(fun) else fun(*fun_param))
 
-    async def get_item(self, key: str, is_json=False):
+    async def get_item(self, key: Union[str, bytes], is_json=False):
         """
         获取缓存
         :param key: 缓存名称
         :param is_json: 是否需要解析成JSON
         """
         if await self.__conn.exists(key):
             info = await self.__conn.get(key)
@@ -80,99 +86,100 @@
 
     async def del_item(self, *args):
         """删除"""
         if not args:
             return
         return await self.__conn.delete(*args)
 
-    async def set_item(self, key: Union[str, int, float, bytes, list, tuple, dict], value, ex_time: int = None):
+    async def set_item(self, key: Union[str, bytes], value: Union[str, int, float, bytes, list, tuple, dict],
+                       ex_time: int = None):
         """
         设置字符串缓存
         :param key: 缓存名称
         :param value: 缓存值，非字符串类型将会自动转换为字符串存储
         :param ex_time: 缓存有效期，默认不设置，既永久有效，类型数字类型 单位：秒 # type:int
         """
         if isinstance(value, (list, tuple, dict)):
             value = json_encode(value)
         return await self.__conn.set(key, value, ex=ex_time)
 
-    async def exists(self, key: (str, bytes)):
+    async def exists(self, key: Union[str, bytes]):
         """检查key是否存在"""
         return await self.__conn.exists(key)
 
-    async def drop_item(self, key: str or bytes):
+    async def drop_item(self, key: Union[str, bytes]):
         """
         根据key删除某项缓存
         :param key: 缓存名称
         """
         return await self.__conn.delete(key)
 
-    async def get_hash(self, key: str or bytes, h_key: str or bytes, is_json=False):
+    async def get_hash(self, key: Union[str, bytes], h_key: Union[str, bytes], is_json=False):
         """
         获取Hash值
 
         :param key: 缓存名称
         :param h_key: 缓存键名称
         :param is_json: 是否为JSON
         """
         if await self.__conn.hexists(key, h_key):
             info = await self.__conn.hget(key, h_key)
             return json_parse(info) if is_json else info
 
-    async def set_hash(self, key: str or bytes, h_key: str or bytes, data):
+    async def set_hash(self, key: Union[str, bytes], h_key: Union[str, bytes], data):
         """
         设置Hash
 
         :param key: 缓存名称
         :param h_key: 缓存键名称
         :param data: 保存的数据
         """
         if isinstance(data, list) or isinstance(data, dict):
             data = json_encode(data, log_fun=self.__logs.error if self.__logs else None)
         return await self.__conn.hset(key, h_key, data)
 
-    async def drop_hash(self, key: str or bytes, h_key: str or bytes):
+    async def drop_hash(self, key: Union[str, bytes], h_key: Union[str, bytes]):
         """
         删除Hash值
         :param key: 缓存名称
         :param h_key: 缓存键名称
         """
         return await self.__conn.hdel(key, h_key)
 
-    async def drop_hash_bulk(self, key: str or bytes, key_list: list or tuple):
+    async def drop_hash_bulk(self, key: Union[str, bytes], key_list: list or tuple):
         """
         批量删除Hash值
         :param key: 缓存名称
         :param key_list: 缓存键列表
         """
         key_list and (await self.__conn.hdel(key, *key_list))
 
-    async def get_hash_all(self, key: str or bytes):
+    async def get_hash_all(self, key: Union[str, bytes]):
         """
         获取整个Hash
         :param key: 缓存名
         """
         return await self.__conn.hgetall(key)
 
-    async def get_hash_val(self, key: str or bytes):
+    async def get_hash_val(self, key: Union[str, bytes]):
         """
         获取整个Hash所有值
         :param key: 缓存名
         """
         return await self.__conn.hvals(key)
 
-    async def set_hash_bulk(self, key: str or bytes, h_map: dict):
+    async def set_hash_bulk(self, key: Union[str, bytes], h_map: dict):
         """
         通过字典映射设置或更新多个Hash
         :param key: 缓存名
         :param h_map: 字典映射 -- 必须是{str: str} 或{bytes: str} 或{bytes: bytes} 几种形式
         """
         return await self.__conn.hset(key, mapping=h_map)
 
-    async def scan_hash(self, key: str or bytes, start: int = 0, count: int = 10, match: str = None):
+    async def scan_hash(self, key: Union[str, bytes], start: int = 0, count: int = 10, match: str = None):
         """
         按匹配的条件迭代扫描hash
         """
         return await self.__conn.hscan(key, cursor=start, match=match, count=count)
 
     async def pub_sub(self, channel: Union[str, list, tuple]):
         """消息订阅模型"""
@@ -239,13 +246,10 @@
         获取队列长度
         :param key: 队列/集合名称
         """
         return await self.__conn.llen(key)
 
     async def expired(self, key: Union[str, bytes], t: int, nx=False, xx=False, gt=False, lt=False):
         return await self.__conn.expire(key, time=t, nx=nx, xx=xx, gt=gt, lt=lt)
-
-    async def locked(self, key: str, fun=None, fun_param: (list, tuple) = None, time_out=5):
-        if not fun_param:
-            fun_param = ()
-        async with self.__conn.lock(key, lock_class=RdsLocker, timeout=time_out):
-            return callable(fun) and ((await fun(*fun_param)) if asyncio.iscoroutinefunction(fun) else fun(*fun_param))
+    
+    async def add_count(self, key: Union[str, bytes]):
+        return await self.__conn.incr(key)
```

## Comparing `nsanic-2024.5.16.dist-info/LICENSE` & `nsanic-2024.5.24.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `nsanic-2024.5.16.dist-info/METADATA` & `nsanic-2024.5.24.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: nsanic
-Version: 2024.5.16
+Version: 2024.5.24
 Summary: A web framework who is use sanic + tortoise-orm + redis to quick create http&websocket server.
 Author: DHDONG
 Author-email: zscych@qq.com
 License: MIT
 Keywords: WebServer,Sanic,WebSite Develop,Web Framework
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
```

## Comparing `nsanic-2024.5.16.dist-info/RECORD` & `nsanic-2024.5.24.dist-info/RECORD`

 * *Files 11% similar despite different names*

```diff
@@ -14,29 +14,29 @@
 nsanic/libs/component.py,sha256=gxLOAyL1F4zGqJEYeskzV3E3FgeEIZnN3gzD4EgNGZQ,1276
 nsanic/libs/consts.py,sha256=OHIOgaLY8R8jZRiwDeEDg_3NN7kj-gZ_7HnP6Ccoq4c,3151
 nsanic/libs/crypto.py,sha256=rCuzGGGYSZimdd8OhQCfIdZBUbBnX0FdPNO3sivy1L4,1578
 nsanic/libs/decorator.py,sha256=l5uNOJUM6AXPAfSNer7uy-2ivXJc-yUytbwBxQ-jCSs,3171
 nsanic/libs/file_type.py,sha256=4OBdtXoNedXYpucs_99VdPfQw_Of6d8XFsRtTbGi8k0,1125
 nsanic/libs/manager.py,sha256=LzK5dio5dNmpRqIz6xJP9ai6nQQAh9_ySghTddGCEcA,2728
 nsanic/libs/mult_log.py,sha256=wN-Wu2Q8byarCyu34mBmeBJUPIvmYZy6BVauifRoZDQ,2495
-nsanic/libs/random_maker.py,sha256=_uWRB8HrslPJ4oXrO7EBIMPILpWLsFOiwrGbW9Sz4-k,5263
-nsanic/libs/rds_client.py,sha256=JRDFv6CXlR4GRQqtseXdKgzm6xK7S8UXhwML_9EgUkg,8705
+nsanic/libs/random_maker.py,sha256=PQwQRYPihT3I2BHt-Dold4RbjBnloryBl1t-8OiV0E8,5417
+nsanic/libs/rds_client.py,sha256=0EkZ71riJYIq-Y0X8-OBbW-GvuWJnr6tkMMeJDhrvxY,8937
 nsanic/libs/rds_locker.py,sha256=HcHcXPzgp_giogbFPLGI0ZxILNBtI5vDCdkXZ3JTVcI,1116
 nsanic/libs/tool.py,sha256=7Bp0KkNMiuLnSATXccaBdW5Qz3FWaPykVNemfGu-Xb0,6985
 nsanic/libs/tool_dt.py,sha256=UmNFRKwN87H4i5Tpap2lAUTZx4oQ1mIK-1X-nWtU5Ok,5014
 nsanic/libs/tool_jwt.py,sha256=8QJQ1GtAntFHV0x-CdKxKO7BwoAGpGZX0WvUZOzD-ZA,3070
 nsanic/libs/tool_ws.py,sha256=oNze5tYDGHJvS81qEEpMcOdLUIVFihR06ltUyi8r4NA,1956
 nsanic/orm/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 nsanic/orm/db_index.py,sha256=LmqneAZnHPfWsWNS4wH6F8iyZ56xtXtczglRFOZtgHA,730
 nsanic/orm/db_model.py,sha256=Mo9UcXZM2u2i7PvT-crmqln7VCSyrll3wmvntGFcBnM,18726
 nsanic/orm/mssql_generator.py,sha256=c9q71hljWqBxoNriG0OefwD48w3gVTb62HnFKjreom4,11698
 nsanic/orm/mysql_generator.py,sha256=6AMVa9twa7GRCuTlEga5g2zHJvkCD9YocUwGGcvLQ4Q,11743
 nsanic/orm/pgsql_generator.py,sha256=BMNDAZ-2X9dPbUOBlhR5UJBfqXWpl23KRgTozleKCCQ,11720
 nsanic/orm/rc_model.py,sha256=Rk687YpLZp6XR42UzspTrOVlotlEAlp53RDRfYnlDG8,5037
 test/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 test/test_unit.py,sha256=ru4EliRtBozPFs9UjVTybZ0cMUFtOgjS8FSdNnQFtO4,701
-nsanic-2024.5.16.dist-info/LICENSE,sha256=GSAKapQH5ZIGWlpQTA7v5YrfECyaxaohUb1vJX-qepw,1090
-nsanic-2024.5.16.dist-info/METADATA,sha256=5vTx_PXomW8L50teBElNDWBL2tmAOovIyEWJF6GOegA,4803
-nsanic-2024.5.16.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-nsanic-2024.5.16.dist-info/entry_points.txt,sha256=NJGRx7PJixNk9kbISqsD8AGtQHq1NppCxvEsfEPx43Q,52
-nsanic-2024.5.16.dist-info/top_level.txt,sha256=Y7ottGiwpMZQKgvVy-Jy3SBJdxMFJSJ8ivpRD-c23xI,12
-nsanic-2024.5.16.dist-info/RECORD,,
+nsanic-2024.5.24.dist-info/LICENSE,sha256=GSAKapQH5ZIGWlpQTA7v5YrfECyaxaohUb1vJX-qepw,1090
+nsanic-2024.5.24.dist-info/METADATA,sha256=628DGshcHQ7v9nD5e2zpAg9JnVAMCcFLYe_S02Kr4XI,4803
+nsanic-2024.5.24.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+nsanic-2024.5.24.dist-info/entry_points.txt,sha256=NJGRx7PJixNk9kbISqsD8AGtQHq1NppCxvEsfEPx43Q,52
+nsanic-2024.5.24.dist-info/top_level.txt,sha256=Y7ottGiwpMZQKgvVy-Jy3SBJdxMFJSJ8ivpRD-c23xI,12
+nsanic-2024.5.24.dist-info/RECORD,,
```

