# Comparing `tmp/agixt-1.5.8-py3-none-any.whl.zip` & `tmp/agixt-1.5.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,21 +1,21 @@
-Zip file size: 36713 bytes, number of entries: 19
--rw-r--r--  2.0 unx     3821 b- defN 24-May-01 02:59 agixt/ApiClient.py
--rw-r--r--  2.0 unx     8584 b- defN 24-May-01 02:59 agixt/Chains.py
--rw-r--r--  2.0 unx    10260 b- defN 24-May-01 02:59 agixt/DBConnection.py
--rw-r--r--  2.0 unx      863 b- defN 24-May-01 02:59 agixt/Defaults.py
--rw-r--r--  2.0 unx     9608 b- defN 24-May-01 02:59 agixt/Extensions.py
--rw-r--r--  2.0 unx    36783 b- defN 24-May-01 02:59 agixt/Interactions.py
--rw-r--r--  2.0 unx    23597 b- defN 24-May-01 02:59 agixt/Memories.py
--rw-r--r--  2.0 unx     5228 b- defN 24-May-01 02:59 agixt/Models.py
--rw-r--r--  2.0 unx     3780 b- defN 24-May-01 02:59 agixt/Providers.py
--rw-r--r--  2.0 unx     6315 b- defN 24-May-01 02:59 agixt/Tuning.py
--rw-r--r--  2.0 unx      626 b- defN 24-May-01 02:59 agixt/Tunnel.py
--rw-r--r--  2.0 unx    13286 b- defN 24-May-01 02:59 agixt/Websearch.py
--rw-r--r--  2.0 unx       32 b- defN 24-May-01 02:59 agixt/__init__.py
--rw-r--r--  2.0 unx     1849 b- defN 24-May-01 02:59 agixt/app.py
--rw-r--r--  2.0 unx     1087 b- defN 24-May-01 02:59 agixt-1.5.8.dist-info/LICENSE
--rw-r--r--  2.0 unx    11418 b- defN 24-May-01 02:59 agixt-1.5.8.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-May-01 02:59 agixt-1.5.8.dist-info/WHEEL
--rw-r--r--  2.0 unx        6 b- defN 24-May-01 02:59 agixt-1.5.8.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     1412 b- defN 24-May-01 02:59 agixt-1.5.8.dist-info/RECORD
-19 files, 138647 bytes uncompressed, 34473 bytes compressed:  75.1%
+Zip file size: 36904 bytes, number of entries: 19
+-rw-r--r--  2.0 unx     3821 b- defN 24-May-02 11:44 agixt/ApiClient.py
+-rw-r--r--  2.0 unx     8584 b- defN 24-May-02 11:44 agixt/Chains.py
+-rw-r--r--  2.0 unx    10260 b- defN 24-May-02 11:44 agixt/DBConnection.py
+-rw-r--r--  2.0 unx      863 b- defN 24-May-02 11:44 agixt/Defaults.py
+-rw-r--r--  2.0 unx     9608 b- defN 24-May-02 11:44 agixt/Extensions.py
+-rw-r--r--  2.0 unx    37945 b- defN 24-May-02 11:44 agixt/Interactions.py
+-rw-r--r--  2.0 unx    23597 b- defN 24-May-02 11:44 agixt/Memories.py
+-rw-r--r--  2.0 unx     5228 b- defN 24-May-02 11:44 agixt/Models.py
+-rw-r--r--  2.0 unx     3780 b- defN 24-May-02 11:44 agixt/Providers.py
+-rw-r--r--  2.0 unx     6315 b- defN 24-May-02 11:44 agixt/Tuning.py
+-rw-r--r--  2.0 unx      626 b- defN 24-May-02 11:44 agixt/Tunnel.py
+-rw-r--r--  2.0 unx    13286 b- defN 24-May-02 11:44 agixt/Websearch.py
+-rw-r--r--  2.0 unx       32 b- defN 24-May-02 11:44 agixt/__init__.py
+-rw-r--r--  2.0 unx     1849 b- defN 24-May-02 11:44 agixt/app.py
+-rw-r--r--  2.0 unx     1087 b- defN 24-May-02 11:44 agixt-1.5.9.dist-info/LICENSE
+-rw-r--r--  2.0 unx    11418 b- defN 24-May-02 11:44 agixt-1.5.9.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-02 11:44 agixt-1.5.9.dist-info/WHEEL
+-rw-r--r--  2.0 unx        6 b- defN 24-May-02 11:44 agixt-1.5.9.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1412 b- defN 24-May-02 11:44 agixt-1.5.9.dist-info/RECORD
+19 files, 139809 bytes uncompressed, 34664 bytes compressed:  75.2%
```

## zipnote {}

```diff
@@ -36,23 +36,23 @@
 
 Filename: agixt/__init__.py
 Comment: 
 
 Filename: agixt/app.py
 Comment: 
 
-Filename: agixt-1.5.8.dist-info/LICENSE
+Filename: agixt-1.5.9.dist-info/LICENSE
 Comment: 
 
-Filename: agixt-1.5.8.dist-info/METADATA
+Filename: agixt-1.5.9.dist-info/METADATA
 Comment: 
 
-Filename: agixt-1.5.8.dist-info/WHEEL
+Filename: agixt-1.5.9.dist-info/WHEEL
 Comment: 
 
-Filename: agixt-1.5.8.dist-info/top_level.txt
+Filename: agixt-1.5.9.dist-info/top_level.txt
 Comment: 
 
-Filename: agixt-1.5.8.dist-info/RECORD
+Filename: agixt-1.5.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## agixt/Interactions.py

```diff
@@ -199,15 +199,15 @@
             context += [kwargs["context"]]
         if context != [] and context != "":
             context = "\n".join(context)
             context = f"The user's input causes you remember these things:\n{context}\n"
         else:
             context = ""
         if vision_response != "":
-            context += f"Visual thoughts from viewing images:\n{vision_response}\n"
+            context += f"{self.agent_name}'s visual description from viewing uploaded images by user in this interaction:\n{vision_response}\n"
         if chain_name != "":
             try:
                 for arg, value in kwargs.items():
                     if "{STEP" in value:
                         # get the response from the step number
                         step_response = self.chain.get_step_response(
                             chain_name=chain_name, step_number=step_number
@@ -410,14 +410,15 @@
         disable_memory: bool = True,
         conversation_name: str = "",
         browse_links: bool = False,
         persist_context_in_history: bool = False,
         images: list = [],
         **kwargs,
     ):
+        global AGIXT_URI
         for setting in self.agent.AGENT_CONFIG["settings"]:
             if setting not in kwargs:
                 kwargs[setting] = self.agent.AGENT_CONFIG["settings"][setting]
         if shots == 0:
             shots = 1
         shots = int(shots)
         prompt = "Chat"
@@ -512,32 +513,41 @@
                     )
                 except:
                     logging.warning("Failed to websearch.")
         vision_response = ""
         if "vision_provider" in self.agent.AGENT_CONFIG["settings"]:
             vision_provider = self.agent.AGENT_CONFIG["settings"]["vision_provider"]
             if images != [] and vision_provider != "None" and vision_provider != "":
+                image_urls = []
+                for image in images:
+                    image_url = str(image).replace(
+                        "./WORKSPACE/", f"{AGIXT_URI}/outputs/"
+                    )
+                    image_urls.append(image_url)
+                logging.info(f"Getting vision response for images: {image_urls}")
                 try:
                     vision_response = await self.agent.inference(
-                        prompt=user_input, tokens=tokens, images=images
+                        prompt=user_input, images=image_urls
                     )
-                except:
+                    logging.info(f"Vision Response: {vision_response}")
+                except Exception as e:
+                    logging.error(f"Error getting vision response: {e}")
                     logging.warning("Failed to get vision response.")
-        image_response = ""
         formatted_prompt, unformatted_prompt, tokens = await self.format_prompt(
             user_input=user_input,
             top_results=int(context_results),
             prompt=prompt,
             chain_name=chain_name,
             step_number=step_number,
             conversation_name=conversation_name,
             websearch=websearch,
             vision_response=vision_response,
             **kwargs,
         )
+        logging.info(f"Formatted Prompt: {formatted_prompt}")
         log_message = (
             user_input
             if user_input != "" and persist_context_in_history == False
             else formatted_prompt
         )
         log_interaction(
             agent_name=self.agent_name,
@@ -587,29 +597,39 @@
             )
         # Handle commands if the prompt contains the {COMMANDS} placeholder
         # We handle command injection that DOESN'T allow command execution by using {command_list} in the prompt
         if "{COMMANDS}" in unformatted_prompt:
             await self.execution_agent(conversation_name=conversation_name)
         if self.response != "" and self.response != None:
             agent_settings = self.agent.AGENT_CONFIG["settings"]
+            if "<audio controls>" in self.response:
+                self.response = re.sub(
+                    r"<audio controls>(.*?)</audio>", "", self.response, flags=re.DOTALL
+                )
+            if "<image src=" in self.response:
+                self.response = re.sub(
+                    r"<image src=(.*?)>", "", self.response, flags=re.DOTALL
+                )
+            if "![" in self.response:
+                self.response = re.sub(
+                    r"!\[.*?\]\(.*?\)", "", self.response, flags=re.DOTALL
+                )
             if "tts_provider" in agent_settings:
                 if (
                     agent_settings["tts_provider"] != "None"
                     and agent_settings["tts_provider"] != ""
                 ):
                     tts_response = await self.agent.text_to_speech(text=self.response)
-                    # If tts_response is a not a url starting with http, it is a base64 encoded audio file
                     if not str(tts_response).startswith("http"):
                         file_type = "wav"
                         file_name = f"{uuid.uuid4().hex}.{file_type}"
                         audio_path = f"./WORKSPACE/{file_name}"
                         audio_data = base64.b64decode(tts_response)
                         with open(audio_path, "wb") as f:
                             f.write(audio_data)
-                        global AGIXT_URI
                         tts_response = f'<audio controls><source src="{AGIXT_URI}/outputs/{file_name}" type="audio/wav"></audio>'
                     self.response = f"{self.response}\n\n{tts_response}"
             if disable_memory != True:
                 try:
                     await self.agent_memory.write_text_to_memory(
                         user_input=user_input,
                         text=self.response,
@@ -730,14 +750,16 @@
                                 command_args = json.loads(
                                     '{"command_args": '
                                     + ",".join(command.split(",")[1:])
                                     + "}"
                                 )
                             except:
                                 command_args = {}
+                        logging.info(f"Agent command list: {command_list}")
+                        logging.info(f"Command to execute: {command_name}")
                         if command_name in command_list:
                             # Check if the command is a valid command in the self.agent.available_commands list
                             try:
                                 if bool(self.agent.AUTONOMOUS_EXECUTION) == True:
                                     ext = Extensions(
                                         agent_name=self.agent_name,
                                         agent_config=self.agent.AGENT_CONFIG,
```

## Comparing `agixt-1.5.8.dist-info/LICENSE` & `agixt-1.5.9.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `agixt-1.5.8.dist-info/METADATA` & `agixt-1.5.9.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: agixt
-Version: 1.5.8
+Version: 1.5.9
 Summary: An Artificial Intelligence Automation Platform. AI Instruction management from various providers, has an adaptive memory, and a versatile plugin system with many commands including web browsing. Supports many AI providers and models and growing support every day.
 Author: Josh XT
 Author-email: josh@devxt.com
 Requires-Python: >=3.10
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: agixtsdk ==0.0.36
```

## Comparing `agixt-1.5.8.dist-info/RECORD` & `agixt-1.5.9.dist-info/RECORD`

 * *Files 10% similar despite different names*

```diff
@@ -1,19 +1,19 @@
 agixt/ApiClient.py,sha256=h4-lJbztwfhH2JBLqbcMxZcbiuoW5mwXTiCk6qdr-IU,3821
 agixt/Chains.py,sha256=OA2Uug5GoGK9stv9PYCBtexQC2TkvFNXeWVwuKdxS6E,8584
 agixt/DBConnection.py,sha256=DriRjWcDF4gE0u0O4xTGZZ4fyzGUh_hpFA7w8DvtlKg,10260
 agixt/Defaults.py,sha256=aG8DOfQsDT_QKoX0q3h3e3wTXatidU3Tuz1g7QuXjlI,863
 agixt/Extensions.py,sha256=1uy2TUKMoN-vNIFTaCgNPDHs-ANPmLNwLuJO86h0gD8,9608
-agixt/Interactions.py,sha256=rdiDDdldIrT5dDHT6RYWY99MkFiuwGzmR5wr-6k1r7U,36783
+agixt/Interactions.py,sha256=Rkt4_Xy8OmtbOeUjL1Dmxk0OV1Ru3gCJaOGfs5X2HJM,37945
 agixt/Memories.py,sha256=j0qC6aVGGROU4e8E9bImnIcG7ASAnLmu7V98UIcdx24,23597
 agixt/Models.py,sha256=Ol3BPZn4LF6I6McrRy0yJeg5OrZu2Oo2qjrkOfIfoHI,5228
 agixt/Providers.py,sha256=FuHJF5IxDIq0XNPnmEHKKyp1sJjkaqAQaN6xY4UIfXo,3780
 agixt/Tuning.py,sha256=4jNPRnFxGf2o1URE1XayvaKjMgSVEIhRQfNkUnIZLoo,6315
 agixt/Tunnel.py,sha256=WMCLOCzQzgUe8K_uC-UlktlUFsmSooZh4RnbdYgXOeA,626
 agixt/Websearch.py,sha256=mNrduLTy0FUiZLH7K3BvUdbXSREPHp0tD4U_Wq6f0Ts,13286
 agixt/__init__.py,sha256=w6buZkD-oYiO4B6POcfvaq2ZYK5xJPsEHhyMZ_pev_w,32
 agixt/app.py,sha256=jtVnexyZ9hbusqJXq6ydUlg_iXfjq4HXloyADR0dikU,1849
-agixt-1.5.8.dist-info/LICENSE,sha256=HKTvkW16ytKDrayEK3xZp5w6Q71SjoczlgrhsRGwYdE,1087
-agixt-1.5.8.dist-info/METADATA,sha256=srprv0nrAdmLvWbu-mm8HNq0vad9K1I6HFvXDUoxXbs,11418
-agixt-1.5.8.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-agixt-1.5.8.dist-info/top_level.txt,sha256=xy7elM44RntvahpvIewrUnjc2fQPfpt-6xPoRfFQTzg,6
-agixt-1.5.8.dist-info/RECORD,,
+agixt-1.5.9.dist-info/LICENSE,sha256=HKTvkW16ytKDrayEK3xZp5w6Q71SjoczlgrhsRGwYdE,1087
+agixt-1.5.9.dist-info/METADATA,sha256=uAFxZ1f5r7SL7WLQS0GwXAR7ZcWBdt7Hgvm5igCddW0,11418
+agixt-1.5.9.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+agixt-1.5.9.dist-info/top_level.txt,sha256=xy7elM44RntvahpvIewrUnjc2fQPfpt-6xPoRfFQTzg,6
+agixt-1.5.9.dist-info/RECORD,,
```

