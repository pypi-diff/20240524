# Comparing `tmp/darli-0.4.2-py3-none-any.whl.zip` & `tmp/darli-0.4.3-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,47 +1,47 @@
-Zip file size: 45997 bytes, number of entries: 45
--rw-r--r--  2.0 unx       92 b- defN 24-Apr-16 10:54 darli/__init__.py
--rw-r--r--  2.0 unx      283 b- defN 24-Apr-16 10:54 darli/backend/__init__.py
--rw-r--r--  2.0 unx     8481 b- defN 24-Apr-16 10:54 darli/backend/_base.py
--rw-r--r--  2.0 unx    15153 b- defN 24-Apr-16 10:54 darli/backend/_casadi.py
--rw-r--r--  2.0 unx    16905 b- defN 24-Apr-16 10:54 darli/backend/_pinocchio.py
--rw-r--r--  2.0 unx       89 b- defN 24-Apr-16 10:54 darli/backend/liecasadi/__init__.py
--rw-r--r--  2.0 unx     3948 b- defN 24-Apr-16 10:54 darli/backend/liecasadi/quaternion.py
--rw-r--r--  2.0 unx     7227 b- defN 24-Apr-16 10:54 darli/backend/liecasadi/so3.py
--rw-r--r--  2.0 unx      211 b- defN 24-Apr-16 10:54 darli/backend/liecasadi/hints/__init__.py
--rw-r--r--  2.0 unx      142 b- defN 24-Apr-16 10:54 darli/model/__init__.py
--rw-r--r--  2.0 unx     6869 b- defN 24-Apr-16 10:54 darli/model/_base.py
--rw-r--r--  2.0 unx     6202 b- defN 24-Apr-16 10:54 darli/model/_body.py
--rw-r--r--  2.0 unx     2967 b- defN 24-Apr-16 10:54 darli/model/_contact.py
--rw-r--r--  2.0 unx     9954 b- defN 24-Apr-16 10:54 darli/model/_model.py
--rw-r--r--  2.0 unx      105 b- defN 24-Apr-16 10:54 darli/model/functional/__init__.py
--rw-r--r--  2.0 unx     7906 b- defN 24-Apr-16 10:54 darli/model/functional/_body.py
--rw-r--r--  2.0 unx     1631 b- defN 24-Apr-16 10:54 darli/model/functional/_contact.py
--rw-r--r--  2.0 unx    10444 b- defN 24-Apr-16 10:54 darli/model/functional/_model.py
--rw-r--r--  2.0 unx       62 b- defN 24-Apr-16 10:54 darli/parametric/__init__.py
--rw-r--r--  2.0 unx     9623 b- defN 24-Apr-16 10:54 darli/parametric/_functional.py
--rw-r--r--  2.0 unx    11502 b- defN 24-Apr-16 10:54 darli/parametric/_model.py
--rw-r--r--  2.0 unx       61 b- defN 24-Apr-16 10:54 darli/robots/__init__.py
--rw-r--r--  2.0 unx     4464 b- defN 24-Apr-16 10:54 darli/robots/_robots.py
--rw-r--r--  2.0 unx      193 b- defN 24-Apr-16 10:54 darli/state_space/__init__.py
--rw-r--r--  2.0 unx     1027 b- defN 24-Apr-16 10:54 darli/state_space/_base.py
--rw-r--r--  2.0 unx     2135 b- defN 24-Apr-16 10:54 darli/state_space/_casadi.py
--rw-r--r--  2.0 unx     4995 b- defN 24-Apr-16 10:54 darli/state_space/_common.py
--rw-r--r--  2.0 unx     6324 b- defN 24-Apr-16 10:54 darli/state_space/_functional.py
--rw-r--r--  2.0 unx      600 b- defN 24-Apr-16 10:54 darli/state_space/_pinocchio.py
--rw-r--r--  2.0 unx     1097 b- defN 24-Apr-16 10:54 darli/state_space/_state_space.py
--rw-r--r--  2.0 unx     1328 b- defN 24-Apr-16 10:54 darli/state_space/integrators/__init__.py
--rw-r--r--  2.0 unx     3455 b- defN 24-Apr-16 10:54 darli/state_space/integrators/_base.py
--rw-r--r--  2.0 unx     1707 b- defN 24-Apr-16 10:54 darli/state_space/integrators/_fwd_euler.py
--rw-r--r--  2.0 unx     1933 b- defN 24-Apr-16 10:54 darli/state_space/integrators/_mid_point.py
--rw-r--r--  2.0 unx     2090 b- defN 24-Apr-16 10:54 darli/state_space/integrators/_rk4.py
--rw-r--r--  2.0 unx      193 b- defN 24-Apr-16 10:54 darli/utils/arrays/__init__.py
--rw-r--r--  2.0 unx     2333 b- defN 24-Apr-16 10:54 darli/utils/arrays/_arraylike.py
--rw-r--r--  2.0 unx     4578 b- defN 24-Apr-16 10:54 darli/utils/arrays/_casadi.py
--rw-r--r--  2.0 unx     4754 b- defN 24-Apr-16 10:54 darli/utils/arrays/_numpy.py
--rw-r--r--  2.0 unx       72 b- defN 24-Apr-16 10:54 darli/utils/quaternions/__init__.py
--rw-r--r--  2.0 unx     2597 b- defN 24-Apr-16 10:54 darli/utils/quaternions/_quaternions.py
--rw-r--r--  2.0 unx     7169 b- defN 24-Apr-16 10:54 darli-0.4.2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Apr-16 10:54 darli-0.4.2.dist-info/WHEEL
--rw-r--r--  2.0 unx        6 b- defN 24-Apr-16 10:54 darli-0.4.2.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3843 b- defN 24-Apr-16 10:54 darli-0.4.2.dist-info/RECORD
-45 files, 176842 bytes uncompressed, 39855 bytes compressed:  77.5%
+Zip file size: 47449 bytes, number of entries: 45
+-rw-r--r--  2.0 unx       92 b- defN 24-May-24 13:18 darli/__init__.py
+-rw-r--r--  2.0 unx      283 b- defN 24-May-24 13:18 darli/backend/__init__.py
+-rw-r--r--  2.0 unx     8644 b- defN 24-May-24 13:18 darli/backend/_base.py
+-rw-r--r--  2.0 unx    18811 b- defN 24-May-24 13:18 darli/backend/_casadi.py
+-rw-r--r--  2.0 unx    19962 b- defN 24-May-24 13:18 darli/backend/_pinocchio.py
+-rw-r--r--  2.0 unx       89 b- defN 24-May-24 13:18 darli/backend/liecasadi/__init__.py
+-rw-r--r--  2.0 unx     3948 b- defN 24-May-24 13:18 darli/backend/liecasadi/quaternion.py
+-rw-r--r--  2.0 unx     7227 b- defN 24-May-24 13:18 darli/backend/liecasadi/so3.py
+-rw-r--r--  2.0 unx      211 b- defN 24-May-24 13:18 darli/backend/liecasadi/hints/__init__.py
+-rw-r--r--  2.0 unx      142 b- defN 24-May-24 13:18 darli/model/__init__.py
+-rw-r--r--  2.0 unx     6869 b- defN 24-May-24 13:18 darli/model/_base.py
+-rw-r--r--  2.0 unx     6202 b- defN 24-May-24 13:18 darli/model/_body.py
+-rw-r--r--  2.0 unx     2967 b- defN 24-May-24 13:18 darli/model/_contact.py
+-rw-r--r--  2.0 unx     9944 b- defN 24-May-24 13:18 darli/model/_model.py
+-rw-r--r--  2.0 unx      105 b- defN 24-May-24 13:18 darli/model/functional/__init__.py
+-rw-r--r--  2.0 unx     7906 b- defN 24-May-24 13:18 darli/model/functional/_body.py
+-rw-r--r--  2.0 unx     1631 b- defN 24-May-24 13:18 darli/model/functional/_contact.py
+-rw-r--r--  2.0 unx    10444 b- defN 24-May-24 13:18 darli/model/functional/_model.py
+-rw-r--r--  2.0 unx       62 b- defN 24-May-24 13:18 darli/parametric/__init__.py
+-rw-r--r--  2.0 unx     9883 b- defN 24-May-24 13:18 darli/parametric/_functional.py
+-rw-r--r--  2.0 unx    12173 b- defN 24-May-24 13:18 darli/parametric/_model.py
+-rw-r--r--  2.0 unx       61 b- defN 24-May-24 13:18 darli/robots/__init__.py
+-rw-r--r--  2.0 unx     4464 b- defN 24-May-24 13:18 darli/robots/_robots.py
+-rw-r--r--  2.0 unx      193 b- defN 24-May-24 13:18 darli/state_space/__init__.py
+-rw-r--r--  2.0 unx     1027 b- defN 24-May-24 13:18 darli/state_space/_base.py
+-rw-r--r--  2.0 unx     2135 b- defN 24-May-24 13:18 darli/state_space/_casadi.py
+-rw-r--r--  2.0 unx     4995 b- defN 24-May-24 13:18 darli/state_space/_common.py
+-rw-r--r--  2.0 unx     6324 b- defN 24-May-24 13:18 darli/state_space/_functional.py
+-rw-r--r--  2.0 unx      600 b- defN 24-May-24 13:18 darli/state_space/_pinocchio.py
+-rw-r--r--  2.0 unx     1097 b- defN 24-May-24 13:18 darli/state_space/_state_space.py
+-rw-r--r--  2.0 unx     1328 b- defN 24-May-24 13:18 darli/state_space/integrators/__init__.py
+-rw-r--r--  2.0 unx     3455 b- defN 24-May-24 13:18 darli/state_space/integrators/_base.py
+-rw-r--r--  2.0 unx     1707 b- defN 24-May-24 13:18 darli/state_space/integrators/_fwd_euler.py
+-rw-r--r--  2.0 unx     1933 b- defN 24-May-24 13:18 darli/state_space/integrators/_mid_point.py
+-rw-r--r--  2.0 unx     2090 b- defN 24-May-24 13:18 darli/state_space/integrators/_rk4.py
+-rw-r--r--  2.0 unx      193 b- defN 24-May-24 13:18 darli/utils/arrays/__init__.py
+-rw-r--r--  2.0 unx     2333 b- defN 24-May-24 13:18 darli/utils/arrays/_arraylike.py
+-rw-r--r--  2.0 unx     4578 b- defN 24-May-24 13:18 darli/utils/arrays/_casadi.py
+-rw-r--r--  2.0 unx     4754 b- defN 24-May-24 13:18 darli/utils/arrays/_numpy.py
+-rw-r--r--  2.0 unx       72 b- defN 24-May-24 13:18 darli/utils/quaternions/__init__.py
+-rw-r--r--  2.0 unx     2597 b- defN 24-May-24 13:18 darli/utils/quaternions/_quaternions.py
+-rw-r--r--  2.0 unx     7169 b- defN 24-May-24 13:18 darli-0.4.3.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-24 13:18 darli-0.4.3.dist-info/WHEEL
+-rw-r--r--  2.0 unx        6 b- defN 24-May-24 13:18 darli-0.4.3.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3843 b- defN 24-May-24 13:18 darli-0.4.3.dist-info/RECORD
+45 files, 184641 bytes uncompressed, 41307 bytes compressed:  77.6%
```

## zipnote {}

```diff
@@ -117,20 +117,20 @@
 
 Filename: darli/utils/quaternions/__init__.py
 Comment: 
 
 Filename: darli/utils/quaternions/_quaternions.py
 Comment: 
 
-Filename: darli-0.4.2.dist-info/METADATA
+Filename: darli-0.4.3.dist-info/METADATA
 Comment: 
 
-Filename: darli-0.4.2.dist-info/WHEEL
+Filename: darli-0.4.3.dist-info/WHEEL
 Comment: 
 
-Filename: darli-0.4.2.dist-info/top_level.txt
+Filename: darli-0.4.3.dist-info/top_level.txt
 Comment: 
 
-Filename: darli-0.4.2.dist-info/RECORD
+Filename: darli-0.4.3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## darli/backend/_base.py

```diff
@@ -303,14 +303,22 @@
     def potential_regressor(
         self,
         q: ArrayLike | None = None,
     ) -> ArrayLike:
         pass
 
     @abstractmethod
+    def momentum_regressor(
+        self,
+        q: ArrayLike | None = None,
+        v: ArrayLike | None = None,
+    ):
+        pass
+
+    @abstractmethod
     def centroidal_dynamics(
         self,
         q: ArrayLike | None = None,
         v: ArrayLike | None = None,
         dv: ArrayLike | None = None,
     ) -> CentroidalDynamics:
         pass
@@ -327,8 +335,9 @@
 
     @abstractmethod
     def integrate_configuration(
         self,
         q: ArrayLike | None = None,
         v: ArrayLike | None = None,
         dt: float = 1,
-    ) -> ArrayLike: ...
+    ) -> ArrayLike:
+        ...
```

## darli/backend/_casadi.py

```diff
@@ -324,21 +324,126 @@
         self,
         q: ArrayLike | None = None,
     ) -> ArrayLike:
         return self.__kindyn.potentialEnergyRegressor()(
             q=q if q is not None else self._q,
         )["potential_regressor"]
 
+    def _spatial_kinetic_energy_jacobian(self):
+        # Define CasADi symbolic variables
+        v = cs.SX.sym("v", 3)
+        w = cs.SX.sym("w", 3)
+
+        # Define the Jacobian matrix as a CasADi SX matrix
+        jacobian = cs.SX.zeros(10, 6)
+
+        jacobian[0, :] = cs.vertcat(v[0], v[1], v[2], 0, 0, 0)
+        jacobian[1, :] = cs.vertcat(0, w[2], -w[1], 0, -v[2], v[1])
+        jacobian[2, :] = cs.vertcat(-w[2], 0, w[0], v[2], 0, -v[0])
+        jacobian[3, :] = cs.vertcat(w[1], -w[0], 0, -v[1], v[0], 0)
+        jacobian[4, :] = cs.vertcat(0, 0, 0, w[0], 0, 0)
+        jacobian[5, :] = cs.vertcat(0, 0, 0, w[1], w[0], 0)
+        jacobian[6, :] = cs.vertcat(0, 0, 0, 0, w[1], 0)
+        jacobian[7, :] = cs.vertcat(0, 0, 0, w[2], 0, w[0])
+        jacobian[8, :] = cs.vertcat(0, 0, 0, 0, w[2], w[1])
+        jacobian[9, :] = cs.vertcat(0, 0, 0, 0, 0, w[2])
+
+        # Transpose the Jacobian matrix
+        jacobian_transposed = jacobian.T
+
+        # Define the CasADi function
+        spatial_kinetic_energy_jacobian = cs.Function(
+            "spatial_kinetic_energy_jacobian",
+            [v, w],
+            [jacobian_transposed],
+        )
+
+        return spatial_kinetic_energy_jacobian
+
+    def momentum_regressor(
+        self,
+        q_inp: ArrayLike | None = None,
+        v_inp: ArrayLike | None = None,
+    ):
+        # store functions
+        spatial_kinetic_energy_jacobian = self._spatial_kinetic_energy_jacobian()
+        torque_reg_fn = self.__kindyn.jointTorqueRegressor()
+
+        # static regressor Y(q, 0, 0)
+        static = torque_reg_fn(
+            q=self._q,
+            v=cs.SX.zeros(self.nv),
+            a=cs.SX.zeros(self.nv),
+        )["regressor"]
+
+        # phi_p = M(q) @ v = (Y(q, 0, v) - Y(q, 0, 0)) @ v
+        phi_p = (
+            torque_reg_fn(
+                q=self._q,
+                v=cs.SX.zeros(self.nv),
+                a=self._v,
+            )["regressor"]
+            - static
+        )
+
+        # compute the partial derivative of lagrangian w.r.t. configuration
+        dphi_h = cs.SX.zeros(*static.shape)
+
+        joint_idx = 0
+        for idx, joint_name in enumerate(self.joint_names):
+            if self.__kindyn.joint_nq(joint_name) == 0:
+                continue
+            # find the joint index
+            body_urdf_name = self.__kindyn.parentLink(joint_name)
+
+            # find spatial velocity
+            lin_vel = self.__kindyn.frameVelocity(
+                body_urdf_name, self.__frame_mapping["local"]
+            )(q=self._q, qdot=self._v)["ee_vel_linear"]
+
+            ang_vel = self.__kindyn.frameVelocity(
+                body_urdf_name, self.__frame_mapping["local"]
+            )(q=self._q, qdot=self._v)["ee_vel_angular"]
+
+            # compute the spatial kinetic energy jacobian
+            phik_dv = spatial_kinetic_energy_jacobian(lin_vel, ang_vel)
+            # compute the velocity derivatives with respect to configuration
+            dvb_dv = self.__kindyn.jointVelocityDerivatives(
+                body_urdf_name, self.__frame_mapping["local"]
+            )(
+                q=self._q,
+                v=self._v,
+            )["v_partial_dv"]
+
+            phik_dv_joint = dvb_dv.T @ phik_dv
+            dphi_h[:, joint_idx * 10 : (joint_idx + 1) * 10] = phik_dv_joint
+            joint_idx += 1
+
+        dphi_h -= static
+
+        return cs.Function(
+            "momentum_regressor",
+            [self._q, self._v],
+            [phi_p, dphi_h],
+            ["q", "v"],
+            ["phi_p", "dphi_h"],
+        )(
+            q_inp if q_inp is not None else self._q,
+            v_inp if v_inp is not None else self._v,
+        )
+
     def update_body(self, body: str, body_urdf_name: str = None) -> BodyInfo:
         if body_urdf_name is None:
             body_urdf_name = body
         return BodyInfo(
             position=self.__kindyn.fk(body_urdf_name)(q=self._q)["ee_pos"],
             rotation=self.__kindyn.fk(body_urdf_name)(q=self._q)["ee_rot"],
-            quaternion=SO3.from_matrix(self.__kindyn.fk(body_urdf_name)(q=self._q)["ee_rot"]).xyzw,
+            quaternion=SO3.from_matrix(
+                self.__kindyn.fk(body_urdf_name)(q=self._q)["ee_rot"]
+            ).xyzw,
             jacobian={
                 Frame.from_str(frame): self.__kindyn.jacobian(
                     body_urdf_name, self.__frame_mapping[frame]
                 )(q=self._q)["J"]
                 for frame in self.__frame_types
             },
             lin_vel={
```

## darli/backend/_pinocchio.py

```diff
@@ -196,14 +196,17 @@
             if dv is None:
                 self._dv = pin.aba(
                     self.__model, self.__data, self._q, self._v, self._tau
                 )
 
         pin.computeAllTerms(self.__model, self.__data, self._q, self._v)
         pin.jacobianCenterOfMass(self.__model, self.__data, self._q)
+        pin.computeForwardKinematicsDerivatives(
+            self.__model, self.__data, self._q, self._v, self._dv
+        )
         self.__dJcom_dt = pin.getCenterOfMassVelocityDerivatives(
             self.__model, self.__data
         )
 
         if dv is not None or tau is not None:
             # we have to calculate centerOfMass only if we computed dv previously
             pin.centerOfMass(self.__model, self.__data, self._q, self._v, self._dv)
@@ -396,14 +399,99 @@
             regressor[0, i * 10 + 0] = g.dot(r)
             regressor[0, i * 10 + 1] = res[0]
             regressor[0, i * 10 + 2] = res[1]
             regressor[0, i * 10 + 3] = res[2]
 
         return regressor
 
+    def _spatial_kinetic_energy_jacobian(self, v, w):
+        # spatial kinetic energy regressor jacobian with respect to velocity and angular velocityf
+        jacobian = np.array(
+            [
+                [v[0], v[1], v[2], 0, 0, 0],
+                [0, w[2], -w[1], 0, -v[2], v[1]],
+                [-w[2], 0, w[0], v[2], 0, -v[0]],
+                [w[1], -w[0], 0, -v[1], v[0], 0],
+                [0, 0, 0, w[0], 0, 0],
+                [0, 0, 0, w[1], w[0], 0],
+                [0, 0, 0, 0, w[1], 0],
+                [0, 0, 0, w[2], 0, w[0]],
+                [0, 0, 0, 0, w[2], w[1]],
+                [0, 0, 0, 0, 0, w[2]],
+            ]
+        )
+        return jacobian.T
+
+    def momentum_regressor(
+        self,
+        q: ArrayLike | None = None,
+        v: ArrayLike | None = None,
+    ) -> tuple[ArrayLike, ArrayLike]:
+        """momentum_regressor computes parametric momentum and
+            partial derivative of lagrangian with respect to configuration
+
+        Args:
+            q (ArrayLike | None, optional): _description_. Defaults to None.
+            v (ArrayLike | None, optional): _description_. Defaults to None.
+
+        Returns:
+            tuple[ArrayLike, ArrayLike]: momentum regressor and partial derivative of lagrangian regressor
+        """
+        if q is not None or v is not None:
+            self._q = q if q is not None else self._q
+            self._v = v if v is not None else self._v
+            pin.computeAllTerms(self.__model, self.__data, q, v)
+
+        # static regressor Y(q, 0, 0)
+        pin.computeJointTorqueRegressor(
+            self.__model,
+            self.__data,
+            self._q,
+            np.zeros(self.nv),
+            np.zeros(self.nv),
+        )
+        static = self.__data.jointTorqueRegressor.copy()
+
+        # phi_p = M(q) v = (Y(q, 0, v) - Y(q, 0, 0)) @ theta
+        pin.computeJointTorqueRegressor(
+            self.__model,
+            self.__data,
+            self._q,
+            np.zeros(self.nv),
+            self._v,
+        )
+        phi_p = self.__data.jointTorqueRegressor.copy() - static.copy()
+
+        # compute the derivative
+        dphi_h = np.zeros_like(phi_p)
+        for i in range(self.nbodies):
+            spatial_vel = pin.getVelocity(
+                self._pinmodel,
+                self._pindata,
+                i + 1,
+                pin.LOCAL,
+            )
+            velocity_derivatives = pin.getJointVelocityDerivatives(
+                self._pinmodel,
+                self._pindata,
+                i + 1,
+                pin.LOCAL,
+            )
+
+            dvb_dv = velocity_derivatives[1].copy()
+            phik_dv = self._spatial_kinetic_energy_jacobian(
+                spatial_vel.linear.copy(), spatial_vel.angular.copy()
+            )
+            phik_dv_joint = dvb_dv.T @ phik_dv
+            dphi_h[:, i * 10 : (i + 1) * 10] = phik_dv_joint.copy()
+
+        dphi_h -= static
+
+        return phi_p, dphi_h
+
     def update_body(self, body: str, body_urdf_name: str = None) -> BodyInfo:
         if body_urdf_name is None:
             body_urdf_name = body
 
         # if we have cached information about body, clean it
         if body_urdf_name in self.__body_info_cache:
             return self.__body_info_cache[body_urdf_name]
```

## darli/model/_model.py

```diff
@@ -202,15 +202,15 @@
             v if v is not None else self._v,
             self._backend.math.zeros(self._backend.nv).array,
         )
 
     def momentum(
         self, q: ArrayLike | None = None, v: ArrayLike | None = None
     ) -> ArrayLike:
-        raise NotImplementedError("Implement me pls")  # FIXME: implement me
+        return self.inertia(q) @ (v if v is not None else self._v)
 
     def lagrangian(
         self, q: ArrayLike | None = None, v: ArrayLike | None = None
     ) -> ArrayLike:
         return self._backend.kinetic_energy(
             q if q is not None else self._q,
             v if v is not None else self._v,
```

## darli/parametric/_functional.py

```diff
@@ -54,14 +54,21 @@
             potential=cs.Function(
                 "potential_regressor",
                 [self.q],
                 [regrs.potential],
                 ["q"],
                 ["potential_regressor"],
             ),
+            momentum=cs.Function(
+                "momentum_regressor",
+                [self.q, self.v],
+                [*regrs.momentum],
+                ["q", "v"],
+                ["momentum_regressor", "partial_lagrangian_configuration"],
+            ),
         )
 
     @property
     def parameters(self) -> ArrayLike:
         return self.__robot._parameters
 
     @property
```

## darli/parametric/_model.py

```diff
@@ -9,15 +9,15 @@
 
 
 @dataclass
 class Regressors:
     torque: ArrayLike
     kinetic: ArrayLike
     potential: ArrayLike
-    # TODO: momentum later
+    momentum: tuple[ArrayLike, ArrayLike]
 
 
 class Model(ModelBase):
     def __init__(self, backend: BackendBase):
         self._backend = backend
 
         self._q = self._backend._q
@@ -58,14 +58,18 @@
             kinetic=self._backend.kinetic_regressor(
                 q if q is not None else self.q,
                 v if v is not None else self.v,
             ),
             potential=self._backend.potential_regressor(
                 q if q is not None else self.q,
             ),
+            momentum=self._backend.momentum_regressor(
+                q if q is not None else self.q,
+                v if v is not None else self.v,
+            ),
         )
 
     @property
     def parameters(self) -> ArrayLike:
         return self._parameters
 
     @property
@@ -272,15 +276,25 @@
             )
             @ self._parameters
         )
 
     def momentum(
         self, q: ArrayLike | None = None, v: ArrayLike | None = None
     ) -> ArrayLike:
-        pass
+        Y_momentum = self._backend.torque_regressor(
+            q if q is not None else self._q,
+            self._backend.math.zeros(self._backend.nv).array,
+            v if v is not None else self._v,
+        )
+        Y_static = self._backend.torque_regressor(
+            q if q is not None else self._q,
+            self._backend.math.zeros(self._backend.nv).array,
+            self._backend.math.zeros(self._backend.nv).array,
+        )
+        return (Y_momentum - Y_static) @ self._parameters
 
     def lagrangian(
         self, q: ArrayLike | None = None, v: ArrayLike | None = None
     ) -> ArrayLike:
         return (
             self._backend.kinetic_regressor(
                 q if q is not None else self._q,
```

## Comparing `darli-0.4.2.dist-info/METADATA` & `darli-0.4.3.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,17 +1,17 @@
 Metadata-Version: 2.1
 Name: darli
-Version: 0.4.2
+Version: 0.4.3
 Summary: The DARLi is a Python 3 library that supports both numerical and symbolical computations of open loop articulated robots provided urdf file.
 Author: Lev Kozlov, Simeon Nedelchev
 Project-URL: homepage, https://github.com/simeon-ned/darli
 Project-URL: repository, https://github.com/simeon-ned/darli.git
 Requires-Python: >=3.9
 Description-Content-Type: text/markdown
-Requires-Dist: cmeel-casadi-kin-dyn >=1.6.11
+Requires-Dist: cmeel-casadi-kin-dyn >=1.6.14
 Provides-Extra: dev
 Requires-Dist: pre-commit ; extra == 'dev'
 
 # DARLi: Differentiable Articulated Robotics Library
 
 The DARLi (Differentiable Articulated Robotics Library) is a wrapper around the CasADi kinematics/dynamics and Pinocchio libraries. Its primary goal is to facilitate the creation of differentiable models for robotic systems, provided a URDF (Unified Robot Description Format) file. **DARLi is not an implementation of mechanics-oriented** algorithms, such as Featherstone's Articulated Body or the Recursive Newton-Euler. Instead, we rely on the efficient implementations provided by [Pinocchio](https://github.com/stack-of-tasks/pinocchio/tree/master) and offer a wrapper that grants easy access to a suite of features that we and our colleagues have found useful in practice of trajectory planning, feedback control, and system identification over poly-articulated robots.
```

## Comparing `darli-0.4.2.dist-info/RECORD` & `darli-0.4.3.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,28 +1,28 @@
 darli/__init__.py,sha256=tCao-fL5Aee2X96eQniUarDN21tCey7-EWum_XoSYwg,92
 darli/backend/__init__.py,sha256=IOH3yKD3ZRuDRS-3QFrsoOBdmQObhRJWm4-y6nFLDq4,283
-darli/backend/_base.py,sha256=NM4bZ5B5AjqFSMMAEQXLrSa7L8KjzfjiGE6MmM5uJpg,8481
-darli/backend/_casadi.py,sha256=tgYzbwrKwgAzYf9cySyItVHrJ38xBRGWPi6AhYyA1Ic,15153
-darli/backend/_pinocchio.py,sha256=RiD090nNvSKIlbtWzXabZMwNSWU97yvk9my_yw7tqwk,16905
+darli/backend/_base.py,sha256=1fn1m_AYWN1P3SbUY3_QDVTkpccsWVQp2pmFFqN62fs,8644
+darli/backend/_casadi.py,sha256=MxcgDQKOnQdzJG16N0srKN9G-cItk9K4yVWsToKdEXs,18811
+darli/backend/_pinocchio.py,sha256=9d9fs4NetWnnsEc9ay56gcEBfMC-LKP8th4oKwz_y3A,19962
 darli/backend/liecasadi/__init__.py,sha256=Ul0PqO0ODIPtqFEXuTzn_eYztdh_DBLcuxvAqa7BGcY,89
 darli/backend/liecasadi/quaternion.py,sha256=wUJZ5ZP62peZkS5EcoGs7WhJ7k_ISqSntYFPkb_GM7s,3948
 darli/backend/liecasadi/so3.py,sha256=byABXzhczxoJzWKO6sgd9dJx-oLBkPwphcihxBPk31A,7227
 darli/backend/liecasadi/hints/__init__.py,sha256=9NEPfSVI3mJ-uzCAGF4d1A7SX2BGxYdXnJfvjholAbs,211
 darli/model/__init__.py,sha256=hvxXYiLLGk-07r7VbqOkEInGcR8_x9ncBeYylrxVoNc,142
 darli/model/_base.py,sha256=VJBhFPsnMSGuZyCz6Zsvmnh7xG0KwLwN-AGDxhJraYU,6869
 darli/model/_body.py,sha256=asau5jQLKHdcHjIkV4dOF9m9tr7S_-cnqOH9ELxVklk,6202
 darli/model/_contact.py,sha256=mCkXyg5zzn_D5pk4QEra5b8oOndGal-3IACHUKYAy3U,2967
-darli/model/_model.py,sha256=68xC6qXJqxt7c11L5RBAyNBJUPOcQZ-WxFEHdo7eXb8,9954
+darli/model/_model.py,sha256=hY_FiPqJlBIWktqnuk6KDh2ZnVMtGpaAd4lgqyS5JPg,9944
 darli/model/functional/__init__.py,sha256=LIr8dFead2_itpOF9FFwI0hdBSnLIJeoWIAzVQRc1N0,105
 darli/model/functional/_body.py,sha256=Qo8Ev86LsEgjoytr-tH3IDcrGZJvz-BpfMClxxU_8ZM,7906
 darli/model/functional/_contact.py,sha256=hW101AvNaTYOFCUFnyYEHVC2RO8sYPMwsSFEEdRRFpU,1631
 darli/model/functional/_model.py,sha256=DxDH6f3zk4_ny-MKVuY7S-5BKGBj1cgHoKLrQzFgDZk,10444
 darli/parametric/__init__.py,sha256=7e2t2unt37wuG2uBPbnai5D2C6qXb1skAe0j9q6af0o,62
-darli/parametric/_functional.py,sha256=8nuHVi8-7Vt9jS_q63B9x-5gA8DSNlewp3kbcOL8kgI,9623
-darli/parametric/_model.py,sha256=tjTTFUmwdgNa2mwAq7NeT2hjNdEL4m45TM-RB9V6Anc,11502
+darli/parametric/_functional.py,sha256=Mg7J2R9B1pMsZ9o_usdr5GDjx8p7j9Azt2nQRxiF29k,9883
+darli/parametric/_model.py,sha256=GazET49LWRbQmS8IdrmnkCeC7F-B0KP_Cc13wNRNngs,12173
 darli/robots/__init__.py,sha256=XMgSjrgMpsx57_gQ4Awu_tvGcd9LKcTNVcF3FC0kB80,61
 darli/robots/_robots.py,sha256=-qzdHmtMazB4OQDysGgSfBxXlxZy4FpnkYmtGBoUTKA,4464
 darli/state_space/__init__.py,sha256=vtDnPwNbfb20KVvf-K5jBch1sc94k13Jhz49vnya3pM,193
 darli/state_space/_base.py,sha256=gEX2xhIje95unYOmbdYfhAaaqj8q9KMA6gssMG0VWY4,1027
 darli/state_space/_casadi.py,sha256=HNlNGJf08lnBw17avSp6Jukg7ZqsMegprZnBfq-0lnM,2135
 darli/state_space/_common.py,sha256=0avcJ1w-D3MBZj0gZfWvd75AvE_IMIhKt_ZmX79Rahs,4995
 darli/state_space/_functional.py,sha256=1ce4F_v2ogPfdNsLCvObkVlP5lbj2leRWnnahTEAoEE,6324
@@ -35,11 +35,11 @@
 darli/state_space/integrators/_rk4.py,sha256=qF4mFhZR9RDiz3-IeCAUV0tM862yfJlIDmKnawNqzNQ,2090
 darli/utils/arrays/__init__.py,sha256=kGlJH-XJyW_B8AgPStYt-Y_isQV7Ga9sHAmW7zTZCqY,193
 darli/utils/arrays/_arraylike.py,sha256=Llhot52a6ExDew2vB-wkevFfiSrbWmUoFNV4q239CqI,2333
 darli/utils/arrays/_casadi.py,sha256=l5QFOcoKvAwYbXZ9X90Tn4uXAzyUTTvVS6hWY4Xw6Po,4578
 darli/utils/arrays/_numpy.py,sha256=VhhWrrqRPfrplq75WlJ0hBT3JpXzrB7uVHmZvF3PCKc,4754
 darli/utils/quaternions/__init__.py,sha256=xNtRVgh3jzvDaejt8JWEdxD_VMejpcrEL3CLX7WCrfU,72
 darli/utils/quaternions/_quaternions.py,sha256=2kXlo_iHSy5aJbglkDvBdehMlobUZduyKGQUuKPThGU,2597
-darli-0.4.2.dist-info/METADATA,sha256=gYz0hk9vWmzGJf6XDjNNMctX0jwS4vC6AM1bT6IdJCA,7169
-darli-0.4.2.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-darli-0.4.2.dist-info/top_level.txt,sha256=qY4otbZCjFkySLgtfbkUvsU-2fS2ES9VBbG0-QKI9MY,6
-darli-0.4.2.dist-info/RECORD,,
+darli-0.4.3.dist-info/METADATA,sha256=qSmaJCvRsbPb4TMFYsgOkQ_jqJRYEqrppRbKJOhueA8,7169
+darli-0.4.3.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+darli-0.4.3.dist-info/top_level.txt,sha256=qY4otbZCjFkySLgtfbkUvsU-2fS2ES9VBbG0-QKI9MY,6
+darli-0.4.3.dist-info/RECORD,,
```

