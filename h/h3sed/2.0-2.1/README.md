# Comparing `tmp/h3sed-2.0-py2.py3-none-any.whl.zip` & `tmp/h3sed-2.1-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,35 +1,37 @@
-Zip file size: 137109 bytes, number of entries: 33
+Zip file size: 142431 bytes, number of entries: 35
 -rw-rw-rw-  2.0 fat       76 b- defN 22-Jan-20 18:23 h3sed/__init__.py
 -rw-rw-rw-  2.0 fat       94 b- defN 22-Jan-20 18:23 h3sed/__main__.py
--rw-rw-rw-  2.0 fat     7940 b- defN 24-Mar-11 20:32 h3sed/conf.py
--rw-rw-rw-  2.0 fat    74162 b- defN 24-Mar-11 18:33 h3sed/gui.py
+-rw-rw-rw-  2.0 fat     7940 b- defN 24-May-24 15:03 h3sed/conf.py
+-rw-rw-rw-  2.0 fat    74162 b- defN 24-May-23 16:57 h3sed/gui.py
 -rw-rw-rw-  2.0 fat    10876 b- defN 24-Jan-21 19:05 h3sed/guibase.py
 -rw-rw-rw-  2.0 fat    41483 b- defN 23-Feb-26 17:55 h3sed/images.py
--rw-rw-rw-  2.0 fat     5800 b- defN 24-Mar-11 18:33 h3sed/main.py
--rw-rw-rw-  2.0 fat    44338 b- defN 24-Mar-11 18:33 h3sed/metadata.py
--rw-rw-rw-  2.0 fat    30068 b- defN 24-Mar-11 18:34 h3sed/templates.py
+-rw-rw-rw-  2.0 fat     5816 b- defN 24-May-23 16:56 h3sed/main.py
+-rw-rw-rw-  2.0 fat    45036 b- defN 24-May-22 17:45 h3sed/metadata.py
+-rw-rw-rw-  2.0 fat    30207 b- defN 24-May-22 18:10 h3sed/templates.py
 -rw-rw-rw-  2.0 fat      255 b- defN 24-Mar-11 18:29 h3sed/etc/h3sed.ini
 -rw-rw-rw-  2.0 fat        0 b- defN 22-Jan-20 18:23 h3sed/lib/__init__.py
 -rw-rw-rw-  2.0 fat    23875 b- defN 24-Jan-29 07:56 h3sed/lib/controls.py
 -rw-rw-rw-  2.0 fat    14180 b- defN 24-Mar-11 18:33 h3sed/lib/util.py
 -rw-rw-rw-  2.0 fat    17561 b- defN 22-Jan-20 18:23 h3sed/lib/wx_accel.py
 -rw-rw-rw-  2.0 fat        0 b- defN 22-Jan-20 18:23 h3sed/lib/vendor/__init__.py
 -rw-rw-rw-  2.0 fat     7920 b- defN 23-Aug-04 19:11 h3sed/lib/vendor/step.py
 -rw-rw-rw-  2.0 fat     6309 b- defN 24-Mar-11 18:33 h3sed/plugins/__init__.py
--rw-rw-rw-  2.0 fat    52400 b- defN 24-Mar-11 20:27 h3sed/plugins/hero/__init__.py
+-rw-rw-rw-  2.0 fat    52400 b- defN 24-May-22 16:22 h3sed/plugins/hero/__init__.py
 -rw-rw-rw-  2.0 fat    10248 b- defN 24-Mar-11 18:33 h3sed/plugins/hero/army.py
--rw-rw-rw-  2.0 fat    15707 b- defN 24-Jan-29 07:56 h3sed/plugins/hero/artifacts.py
--rw-rw-rw-  2.0 fat     6192 b- defN 24-Mar-11 18:31 h3sed/plugins/hero/inventory.py
+-rw-rw-rw-  2.0 fat    15880 b- defN 24-May-23 08:37 h3sed/plugins/hero/artifacts.py
+-rw-rw-rw-  2.0 fat     9358 b- defN 24-May-23 18:47 h3sed/plugins/hero/inventory.py
 -rw-rw-rw-  2.0 fat     7209 b- defN 24-Jan-29 07:56 h3sed/plugins/hero/skills.py
 -rw-rw-rw-  2.0 fat     5709 b- defN 24-Jan-29 07:56 h3sed/plugins/hero/spells.py
 -rw-rw-rw-  2.0 fat     8411 b- defN 24-Jan-29 07:56 h3sed/plugins/hero/stats.py
--rw-rw-rw-  2.0 fat     2227 b- defN 24-Jan-29 07:56 h3sed/plugins/version/__init__.py
--rw-rw-rw-  2.0 fat    16315 b- defN 24-Mar-11 20:10 h3sed/plugins/version/hota.py
--rw-rw-rw-  2.0 fat     6541 b- defN 24-Mar-11 18:34 h3sed/plugins/version/sod.py
--rw-rw-rw-  2.0 fat     1100 b- defN 24-Mar-11 20:33 h3sed-2.0.dist-info/LICENSE.md
--rw-rw-rw-  2.0 fat     4218 b- defN 24-Mar-11 20:33 h3sed-2.0.dist-info/METADATA
--rw-rw-rw-  2.0 fat      110 b- defN 24-Mar-11 20:33 h3sed-2.0.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       37 b- defN 24-Mar-11 20:33 h3sed-2.0.dist-info/entry_points.txt
--rw-rw-rw-  2.0 fat        6 b- defN 24-Mar-11 20:33 h3sed-2.0.dist-info/top_level.txt
--rw-rw-r--  2.0 fat     2605 b- defN 24-Mar-11 20:33 h3sed-2.0.dist-info/RECORD
-33 files, 423972 bytes uncompressed, 133013 bytes compressed:  68.6%
+-rw-rw-rw-  2.0 fat     2213 b- defN 24-May-22 17:24 h3sed/plugins/version/__init__.py
+-rw-rw-rw-  2.0 fat     6874 b- defN 24-May-23 08:38 h3sed/plugins/version/ab.py
+-rw-rw-rw-  2.0 fat    16403 b- defN 24-May-23 08:38 h3sed/plugins/version/hota.py
+-rw-rw-rw-  2.0 fat     4206 b- defN 24-May-23 08:38 h3sed/plugins/version/roe.py
+-rw-rw-rw-  2.0 fat     6623 b- defN 24-May-23 08:38 h3sed/plugins/version/sod.py
+-rw-rw-rw-  2.0 fat     1100 b- defN 24-May-24 15:05 h3sed-2.1.dist-info/LICENSE.md
+-rw-rw-rw-  2.0 fat     4264 b- defN 24-May-24 15:05 h3sed-2.1.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      110 b- defN 24-May-24 15:05 h3sed-2.1.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       37 b- defN 24-May-24 15:05 h3sed-2.1.dist-info/entry_points.txt
+-rw-rw-rw-  2.0 fat        6 b- defN 24-May-24 15:05 h3sed-2.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     2774 b- defN 24-May-24 15:05 h3sed-2.1.dist-info/RECORD
+35 files, 439615 bytes uncompressed, 138073 bytes compressed:  68.6%
```

## zipnote {}

```diff
@@ -69,32 +69,38 @@
 
 Filename: h3sed/plugins/hero/stats.py
 Comment: 
 
 Filename: h3sed/plugins/version/__init__.py
 Comment: 
 
+Filename: h3sed/plugins/version/ab.py
+Comment: 
+
 Filename: h3sed/plugins/version/hota.py
 Comment: 
 
+Filename: h3sed/plugins/version/roe.py
+Comment: 
+
 Filename: h3sed/plugins/version/sod.py
 Comment: 
 
-Filename: h3sed-2.0.dist-info/LICENSE.md
+Filename: h3sed-2.1.dist-info/LICENSE.md
 Comment: 
 
-Filename: h3sed-2.0.dist-info/METADATA
+Filename: h3sed-2.1.dist-info/METADATA
 Comment: 
 
-Filename: h3sed-2.0.dist-info/WHEEL
+Filename: h3sed-2.1.dist-info/WHEEL
 Comment: 
 
-Filename: h3sed-2.0.dist-info/entry_points.txt
+Filename: h3sed-2.1.dist-info/entry_points.txt
 Comment: 
 
-Filename: h3sed-2.0.dist-info/top_level.txt
+Filename: h3sed-2.1.dist-info/top_level.txt
 Comment: 
 
-Filename: h3sed-2.0.dist-info/RECORD
+Filename: h3sed-2.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## h3sed/conf.py

```diff
@@ -5,15 +5,15 @@
 and all values are kept in JSON.
 
 ------------------------------------------------------------------------------
 This file is part of h3sed - Heroes3 Savegame Editor.
 Released under the MIT License.
 
 @created     14.03.2020
-@modified    11.03.2024
+@modified    24.05.2024
 ------------------------------------------------------------------------------
 """
 try: from ConfigParser import RawConfigParser                 # Py2
 except ImportError: from configparser import RawConfigParser  # Py3
 import copy
 import datetime
 import io
@@ -22,16 +22,16 @@
 import re
 import sys
 
 
 """Program title, version number and version date."""
 Name = "h3sed"
 Title = "Heroes3 Savegame Editor"
-Version = "2.0"
-VersionDate = "11.03.2024"
+Version = "2.1"
+VersionDate = "24.05.2024"
 
 if getattr(sys, "frozen", False):
     # Running as a pyinstaller executable
     ApplicationDirectory = os.path.dirname(sys.executable)
     PluginDirectory = os.path.join(getattr(sys, "_MEIPASS", ""), "h3sed", "plugins")
     EtcDirectory = ApplicationDirectory
 else:
```

## h3sed/main.py

```diff
@@ -4,15 +4,15 @@
 handles logging and status calls.
 
 ------------------------------------------------------------------------------
 This file is part of h3sed - Heroes3 Savegame Editor.
 Released under the MIT License.
 
 @created     14.03.2020
-@modified    20.03.2022
+@modified    23.05.2024
 ------------------------------------------------------------------------------
 """
 import argparse
 import gzip
 import locale
 import logging
 import os
@@ -148,15 +148,15 @@
     app.MainLoop()
 
 
 
 def run():
     """Parses command-line arguments and runs GUI."""
     conf.load()
-    argparser = argparse.ArgumentParser(description=ARGUMENTS["description"])
+    argparser = argparse.ArgumentParser(description=ARGUMENTS["description"], prog=conf.Name)
     for arg in ARGUMENTS["arguments"]:
         argparser.add_argument(*arg.pop("args"), **arg)
 
     argv = sys.argv[1:]
     if "nt" == os.name: # Fix Unicode arguments, otherwise converted to ?
         argv = util.win32_unicode_argv()[1:]
     arguments, _ = argparser.parse_known_args(argv)
```

## h3sed/metadata.py

```diff
@@ -3,15 +3,15 @@
 Constants, data store and savefile functionality.
 
 ------------------------------------------------------------------------------
 This file is part of h3sed - Heroes3 Savegame Editor.
 Released under the MIT License.
 
 @created     22.03.2020
-@modified    28.01.2024
+@modified    22.05.2024
 ------------------------------------------------------------------------------
 """
 from collections import defaultdict, OrderedDict
 import copy
 import datetime
 import gzip
 import logging
@@ -1053,15 +1053,15 @@
 
     def detect_version(self):
         """Auto-detects game version, raises error if savefile not recognizable."""
         if not self.RGX_MAGIC.match(self.raw):
             raise ValueError("Not recognized as Heroes3 savefile.")
         if getattr(plugins, "version", None):
             for p in plugins.version.PLUGINS:
-                if p["module"].detect(self.raw):
+                if p["module"].detect(self):
                     logger.info("Detected %s as version %r.", self.filename, p["name"])
                     self.version = p["name"]
                     break  # for p
             if self.version is None:
                 raise ValueError("Not recognized as Heroes3 savefile "
                                  "of any supported game version.")
 
@@ -1094,14 +1094,29 @@
 
 
     def is_changed(self):
         """Returns whether loaded contents have changed."""
         return self.raw != self.raw0
 
 
+    def match_byte_ranges(self, positions, ranges):
+        """
+        Returns whether byte values in savefile uncompressed bytes match given ranges.
+
+        @param   positions  {key: byte index in savefile uncompressed bytes}
+        @param   ranges     {key in positions: (min, max)}, with negative values skipped
+        """
+        if not positions or not ranges or not all(k in positions for k in ranges): return False
+        for k, (minv, maxv) in ranges.items():
+            v = self.raw[positions[k]] if positions[k] < len(self.raw) else None
+            if v is None or (minv >= 0 and v < minv) or (maxv >= 0 and v > maxv):
+                return False
+        return True
+
+
 
 class Store(object):
     """
     Simple data container, allowing to store and retrieve data by version
     and subcategory.
     """
```

## h3sed/templates.py

```diff
@@ -3,15 +3,15 @@
 HTML templates.
 
 ------------------------------------------------------------------------------
 This file is part of h3sed - Heroes3 Savegame Editor.
 Released under the MIT License.
 
 @created     14.03.2020
-@modified    07.03.2024
+@modified    22.05.2024
 ------------------------------------------------------------------------------
 """
 import difflib, re
 # Modules imported inside templates:
 #import datetime, json, sys, wx
 #from h3sed.lib.vendor import step
 #from h3sed.lib import util
@@ -474,15 +474,16 @@
 from h3sed.lib import util
 from h3sed import conf, images, metadata, plugins
 deviceprops = pluginmap["stats"].props()
 deviceprops = deviceprops[next(i for i, x in enumerate(deviceprops) if "spellbook" == x["name"]):]
 %><!DOCTYPE HTML><html lang="en">
 <head>
   <meta http-equiv='Content-Type' content='text/html;charset=utf-8'>
-  <meta name="Author" content="{{ conf.Title }}">
+  <meta name="author" content="{{ conf.Title }}">
+  <meta name="generator" content="{{ conf.Name }} v{{ conf.Version }} ({{ conf.VersionDate }})">
   <title>Heroes of Might & Magic III - Savegame export - Heroes</title>
   <link rel="shortcut icon" type="image/png" href="data:image/png;base64,{{! images.Icon_16x16_16bit.data }}">
   <style>
     * { font-family: Tahoma, "DejaVu Sans", "Open Sans", Verdana; color: black; font-size: 11px; }
     body {
       background-image: url("data:image/png;base64,{{! images.ExportBg.data }}");
       margin: 0;
@@ -494,15 +495,15 @@
     }
     table#heroes { border-spacing: 2px; empty-cells: show; width: 100%; }
     table#heroes td, table#heroes th { border: 1px solid #C0C0C0; padding: 5px; }
     table#heroes th { text-align: left; white-space: nowrap; }
     table#heroes td { vertical-align: top; white-space: nowrap; }
     td.index, th.index { color: gray; width: 10px; }
     td.index { color: gray; text-align: right; }
-    .long { white-space: pre-wrap; }
+    .long { display: inline-block; max-width: 600px; white-space: pre-wrap; }
     a.toggle { font-weight: normal; }
     a.toggle:hover { cursor: pointer; text-decoration: none; }
     a.toggle::after { content: ".. \\25b6"; }
     a.toggle.open::after { content: " \\25b2"; font-size: 0.7em; }
     a.sort { display: block; }
     a.sort:hover { cursor: pointer; text-decoration: none; }
     a.sort::after      { content: ""; display: inline-block; min-width: 6px; position: relative; left: 3px; top: -1px; }
```

### html2text {}

```diff
@@ -1,11 +1,11 @@
 # -*- coding: utf-8 -*- """ HTML templates. -----------------------------------
 ------------------------------------------- This file is part of h3sed -
 Heroes3 Savegame Editor. Released under the MIT License. @created 14.03.2020
-@modified 07.03.2024 ----------------------------------------------------------
+@modified 22.05.2024 ----------------------------------------------------------
 -------------------- """ import difflib, re # Modules imported inside
 templates: #import datetime, json, sys, wx #from h3sed.lib.vendor import step
 #from h3sed.lib import util #from h3sed import conf, images, plugins, templates
 def make_category_diff(v1, v2): """ Returns diff for hero charsheet category
 texts. @param v1 text with old values @param v2 text with new values @return [
 (old line, new line), ] with empty string standing for total change """ LF,
 LFMARKER, ADDED, REMOVED, SAME = "\n", "\\n", "+ ", "- ", " " def make_entries
```

## h3sed/plugins/hero/artifacts.py

```diff
@@ -3,15 +3,15 @@
 Artifacts subplugin for hero-plugin, shows artifact selection slots like helm etc.
 
 ------------------------------------------------------------------------------
 This file is part of h3sed - Heroes3 Savegame Editor.
 Released under the MIT License.
 
 @created   16.03.2020
-@modified  27.01.2024
+@modified  23.05.2024
 ------------------------------------------------------------------------------
 """
 from collections import defaultdict
 import logging
 
 import wx
 
@@ -174,16 +174,16 @@
 
     def props(self):
         """Returns props for artifacts-tab, as [{type: "combo", ..}]."""
         result = []
         version = self._savefile.version
         for prop in UIPROPS:
             slot = prop.get("slot", prop["name"])
-            result.append(dict(prop, choices=[""] + self._cache[slot]))
-        return result
+            result.append(dict(prop, choices=[""] + self._cache.get(slot, [])))
+        return plugins.adapt(self, "props", result)
 
 
     def state(self):
         """Returns data state for artifacts-plugin, as {helm, ..}."""
         return self._state
 
 
@@ -366,15 +366,15 @@
         return slots_free, slots_owner
 
 
     def parse(self, heroes):
         """Returns artifacts states parsed from hero bytearrays, as [{helm, ..}, ]."""
         result = []
         version = self._savefile.version
-        slots = set(p.get("slot", p["name"]) for p in UIPROPS) | set(["inventory", "scroll"])
+        slots = set(p.get("slot", p["name"]) for p in self.props()) | set(["inventory", "scroll"])
         self._cache = {slot: sorted(metadata.Store.get("artifacts", version, category=slot))
                        for slot in slots}
         IDS   = metadata.Store.get("ids", version)
         NAMES = {x[y]: y for x in [IDS] for y in self._cache["inventory"]}
         MYPOS = plugins.adapt(self, "pos", POS)
 
         def parse_item(hero, pos):
@@ -397,18 +397,20 @@
         version = self._savefile.version
 
         IDS = {y: x[y] for x in [metadata.Store.get("ids", version)]
                for y in self._cache["inventory"]}
         SCROLL_ARTIFACTS = self._cache["scroll"]
         MYPOS = plugins.adapt(self, "pos", POS)
         SLOTS = metadata.Store.get("artifact_slots", version)
+        HAS_COMBOS = bool(MYPOS.get("reserved"))
 
-        pos_reserved, len_reserved = min(MYPOS["reserved"].values()), len(MYPOS["reserved"])
-        result[pos_reserved:pos_reserved + len_reserved] = [0] * len_reserved
-        reserved_sets = set()  # [pos updated in combination artifact flags, ]
+        if HAS_COMBOS:
+            pos_reserved, len_reserved = min(MYPOS["reserved"].values()), len(MYPOS["reserved"])
+            result[pos_reserved:pos_reserved + len_reserved] = [0] * len_reserved
+            reserved_sets = set()  # [pos updated in combination artifact flags, ]
 
         state0 = self._hero.state0.get("artifacts") or {}
         for prop in self.props():
             name = self._state[prop["name"]]
             v, pos = IDS.get(name), MYPOS[prop["name"]]
             if name in SCROLL_ARTIFACTS:
                 b = util.itoby(v, 8)
@@ -416,17 +418,17 @@
                 b = util.itoby(v, 4) + metadata.Blank * 4
             elif not state0.get(prop["name"]):
                 # Retain original bytes unchanged, as game uses both 0x00 and 0xFF
                 b = bytes0[pos:pos + 8]
             else:
                 b = metadata.Blank * 8
             result[pos:pos + len(b)] = b
-            for slot in SLOTS.get(name, [])[1:]:
+            for slot in SLOTS.get(name, [])[1:] if HAS_COMBOS else ():
                 result[MYPOS["reserved"][slot]] += 1
                 reserved_sets.add(MYPOS["reserved"][slot])
 
-        for pos in range(pos_reserved, pos_reserved + len_reserved):
+        for pos in range(pos_reserved, pos_reserved + len_reserved) if HAS_COMBOS else ():
             if pos not in reserved_sets and bytes0[pos] > 5:
                 # Retain original bytes unchanged, Horn of the Abyss uses them for unknown purpose.
                 result[pos] = bytes0[pos]
 
         return result
```

## h3sed/plugins/hero/inventory.py

```diff
@@ -3,24 +3,30 @@
 Inventory subplugin for hero-plugin, shows inventory artifacts list.
 
 ------------------------------------------------------------------------------
 This file is part of h3sed - Heroes3 Savegame Editor.
 Released under the MIT License.
 
 @created   16.03.2020
-@modified  27.01.2024
+@modified  23.05.2024
 ------------------------------------------------------------------------------
 """
+import functools
 import logging
 
+import wx
+
+from h3sed import conf
 from h3sed import gui
+from h3sed import guibase
 from h3sed import metadata
 from h3sed import plugins
 from h3sed.lib import util
 from h3sed.plugins.hero import POS
+from h3sed.plugins.hero.artifacts import UIPROPS as ARTIFACT_PROPS
 
 
 logger = logging.getLogger(__package__)
 
 
 
 PROPS = {"name": "inventory", "label": "Inventory", "index": 4}
@@ -110,26 +116,83 @@
             elif v in ("", None):
                 self._state[i] = None
             else:
                 logger.warning("Invalid inventory item #%s: %r", i + 1, v)
         return state0 != self._state
 
 
+    def on_compact_menu(self, event):
+        """Handler for clicking the Compact button, opens popup menu."""
+        menu = wx.Menu()
+        item_current   = wx.MenuItem(menu, -1, "In &current order")
+        item_name      = wx.MenuItem(menu, -1, "In &name order")
+        item_slot_name = wx.MenuItem(menu, -1, "In &slot and name order")
+        item_reverse   = wx.MenuItem(menu, -1, "In &reverse order")
+        menu.Append(item_current)
+        menu.Append(item_name)
+        menu.Append(item_slot_name)
+        menu.Append(item_reverse)
+        menu.Bind(wx.EVT_MENU, lambda e: self.compact_items(),                 item_current)
+        menu.Bind(wx.EVT_MENU, lambda e: self.compact_items(reverse=True),     item_reverse)
+        menu.Bind(wx.EVT_MENU, lambda e: self.compact_items(["name"]),         item_name)
+        menu.Bind(wx.EVT_MENU, lambda e: self.compact_items(["slot", "name"]), item_slot_name)
+        event.EventObject.PopupMenu(menu, (0, event.EventObject.Size.Height))
+
+
+    def compact_items(self, order=(), reverse=False):
+        """Compacts inventory items to top, in specified order if any."""
+        items, sortkeys = [x for x in self._state[:] if x], []
+        if order:
+            SLOTS = metadata.Store.get("artifact_slots", self._savefile.version)
+            slot_order = [x.get("slot", x["name"]) for x in ARTIFACT_PROPS]
+            slot_order += [x for x in set(sum(SLOTS.values(), [])) if x not in slot_order]
+            slot_order += ["unknown"]  # Just in case
+        for name in order:
+            if "name" == name:
+                sortkeys.append(lambda x: x.lower())
+            if "slot" == name:
+                sortkeys.append(lambda x: slot_order.index(SLOTS.get(x, slot_order[-1:])[0]))
+        if sortkeys: items.sort(key=lambda x: tuple(f(x) for f in sortkeys))
+        if reverse:  items = items[::-1]
+        items += [None] * (len(self._state) - len(items))
+        if items == self._state:
+            guibase.status("No change from compacting inventory",
+                           flash=conf.StatusShortFlashLength)
+            return
+
+        def on_do(self, items):
+            self._state[:] = items
+            self.parent.patch()
+            self.render()
+            return True
+        label = " and ".join(order) if order else "reverse" if reverse else "current"
+        guibase.status("Compacting inventory in %s order", label,
+                       flash=conf.StatusShortFlashLength, log=True)
+        callable = functools.partial(on_do, self, items)
+        self.parent.command(callable, name="compact inventory in %s order" % label)
+
+
     def render(self):
         """
         Populates controls from state, using existing if already built.
 
         Returns whether new controls were created.
         """
         if self._ctrls and all(self._ctrls):
             for i, value in enumerate(self._state):
                 self._ctrls[i].Value = value or ""
             return False
         else:
             self._ctrls = gui.build(self, self._panel)[0]
+            button = wx.Button(self._panel, label="Compact ..")
+            button.Bind(wx.EVT_BUTTON, self.on_compact_menu)
+            button.ToolTip = "Pack inventory artifacts to top"
+            self._panel.Sizer.Add(button, border=20, flag=wx.TOP | wx.LEFT)
+            self._panel.Sizer.AddStretchSpacer()
+            self._panel.Layout()
             return True
 
 
     def parse(self, heroes):
         """Returns inventory states parsed from hero bytearrays, as [[item or None, ..], ]."""
         result = []
         IDS   = metadata.Store.get("ids", self._savefile.version)
```

## h3sed/plugins/version/__init__.py

```diff
@@ -6,16 +6,16 @@
 
 
 Subplugin modules are expected to have the following API (most methods optional):
 
     def init():
         '''Called at plugin load.'''
 
-    def detect(bytes):
-        '''Mandatory. Returns whether savefile uncompressed bytes match game version.'''
+    def detect(savefile):
+        '''Mandatory. Returns whether savefile matches game version.'''
 
     def props():
         '''
         Returns plugin props {name, ?label, ?index}.
         Label is used as plugin tab label, falling back to plugin name.
         Index is used for sorting plugins.
         Icon is wx.Bitmap, used as plugin tab icon in rendering notebook.
@@ -30,15 +30,15 @@
         '''
 
 ------------------------------------------------------------------------------
 This file is part of h3sed - Heroes3 Savegame Editor.
 Released under the MIT License.
 
 @created   22.03.2020
-@modified  27.01.2024
+@modified  22.05.2024
 ------------------------------------------------------------------------------
 """
 import copy
 import glob
 import importlib
 import logging
 import os
```

## h3sed/plugins/version/hota.py

```diff
@@ -3,28 +3,35 @@
 Subplugin for HOMM3 version "Horn of the Abyss".
 
 ------------------------------------------------------------------------------
 This file is part of h3sed - Heroes3 Savegame Editor.
 Released under the MIT License.
 
 @created   22.03.2020
-@modified  11.03.2024
+@modified  23.05.2024
 ------------------------------------------------------------------------------
 """
 import logging
 import re
 
 from h3sed.lib import util
 from h3sed.metadata import BytePositions, Store
 
 
 logger = logging.getLogger(__package__)
 
 
-PROPS = {"name": "hota", "label": "Horn of the Abyss", "index": 1}
+PROPS = {"name": "hota", "label": "Horn of the Abyss", "index": 3}
+
+
+"""Game major and minor version byte ranges, as (min, max)."""
+VersionByteRanges = {
+    "version_major":  (44, -1),
+    "version_minor":  ( 5, -1),
+}
 
 
 """Hero skills, in file order, added to default skills."""
 Skills = ["Interference"]
 
 """Hero artifacts, for wearing and side slots, excluding spell scrolls."""
 Artifacts = [
@@ -401,11 +408,10 @@
         result = RGX_HERO
     elif "pos" == category and "hero" == util.get(root, "name"):
         # Update skill slots position
         result = dict(value, **POS)
     return result
 
 
-def detect(raw):
-    """Returns whether savefile uncompressed bytes match Horn of the Abyss."""
-    major, minor = raw[BytePositions["version_major"]], raw[BytePositions["version_minor"]]
-    return major >= 0x2C and minor >= 0x05
+def detect(savefile):
+    """Returns whether savefile bytes match Horn of the Abyss."""
+    return savefile.match_byte_ranges(BytePositions, VersionByteRanges)
```

## h3sed/plugins/version/sod.py

```diff
@@ -3,26 +3,33 @@
 Subplugin for HOMM3 version "Shadow of Death".
 
 ------------------------------------------------------------------------------
 This file is part of h3sed - Heroes3 Savegame Editor.
 Released under the MIT License.
 
 @created   22.03.2020
-@modified  28.01.2024
+@modified  23.05.2024
 ------------------------------------------------------------------------------
 """
 import logging
 
 from h3sed.metadata import BytePositions, Store
 
 
 logger = logging.getLogger(__package__)
 
 
-PROPS = {"name": "sod", "label": "Shadow of Death", "index": 0}
+PROPS = {"name": "sod", "label": "Shadow of Death", "index": 2}
+
+
+"""Game major and minor version byte ranges, as (min, max)."""
+VersionByteRanges = {
+    "version_major":  (42, 43),
+    "version_minor":  ( 2,  4),
+}
 
 
 """Hero artifacts, for wearing and side slots, excluding spell scrolls."""
 Artifacts = [
     "Admiral's Hat",
     "Angelic Alliance",
     "Armageddon's Blade",
@@ -31,15 +38,15 @@
     "Cloak of the Undead King",
     "Cornucopia",
     "Elixir of Life",
     "Power of the Dragon Father",
     "Ring of the Magi",
     "Statue of Legion",
     "Titan's Thunder",
-    "Vial of Dragonblood",
+    "Vial of Dragon Blood",
     "Wizard's Well",
 ]
 
 
 """Creatures for hero army slots."""
 Creatures = [
     "Azure Dragon",
@@ -85,15 +92,15 @@
     "Cloak of the Undead King":          0x82,
     "Cornucopia":                        0x8C,
     "Elixir of Life":                    0x83,
     "Power of the Dragon Father":        0x86,
     "Ring of the Magi":                  0x8B,
     "Statue of Legion":                  0x85,
     "Titan's Thunder":                   0x87,
-    "Vial of Dragonblood":               0x7F,
+    "Vial of Dragon Blood":              0x7F,
     "Wizard's Well":                     0x8A,
 
     # Creatures
     "Azure Dragon":                      0x84,
     "Boar":                              0x8C,
     "Crystal Dragon":                    0x85,
     "Enchanter":                         0x88,
@@ -132,15 +139,15 @@
     "Cloak of the Undead King":          ["cloak", "neck", "feet"],
     "Cornucopia":                        ["side", "hand", "hand", "cloak"],
     "Elixir of Life":                    ["side", "hand", "hand"],
     "Power of the Dragon Father":        ["armor", "helm", "neck", "weapon", "shield", "hand", "hand", "cloak", "feet"],
     "Ring of the Magi":                  ["hand", "neck", "cloak"],
     "Statue of Legion":                  ["side", "side", "side", "side", "side"],
     "Titan's Thunder":                   ["weapon", "helm", "armor", "shield"],
-    "Vial of Dragonblood":               ["side"],
+    "Vial of Dragon Blood":              ["side"],
 }
 
 
 """Primary skill modifiers that artifacts give to hero."""
 ArtifactStats = {
     "Angelic Alliance":                  (21, 21, 21, 21),
     "Armageddon's Blade":                (+3, +3, +3, +6),
@@ -177,11 +184,10 @@
 
 
 def props():
     """Returns props as {label, index}."""
     return PROPS
 
 
-def detect(raw):
-    """Returns whether savefile uncompressed bytes match Shadow of Death."""
-    major, minor = raw[BytePositions["version_major"]], raw[BytePositions["version_minor"]]
-    return 0x2A <= major < 0x2C and minor >= 0x02
+def detect(savefile):
+    """Returns whether savefile bytes match Shadow of Death."""
+    return savefile.match_byte_ranges(BytePositions, VersionByteRanges)
```

## Comparing `h3sed-2.0.dist-info/LICENSE.md` & `h3sed-2.1.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `h3sed-2.0.dist-info/METADATA` & `h3sed-2.1.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: h3sed
-Version: 2.0
+Version: 2.1
 Summary: Heroes3 Savegame Editor
 Home-page: https://github.com/suurjaak/h3sed
 Author: Erki Suurjaak
 Author-email: erki@lap.ee
 License: MIT
 Keywords: homm homm3 heroes3 savegame
 Platform: any
@@ -41,15 +41,15 @@
 - spells, like Slow
 - army creatures, like Golden Dragons
 
 Attributes can be copied from one hero and pasted to another.
 
 Hero data can be exported as HTML or spreadsheet.
 
-Supports savegames from Shadow of Death and Horn of the Abyss.
+Supports savegames from: Restoration of Erathia, Armageddon's Blade, Shadow of Death, and Horn of the Abyss.
 
 Downloads at https://suurjaak.github.io/h3sed.
 
 
 Usage
 -----
```

## Comparing `h3sed-2.0.dist-info/RECORD` & `h3sed-2.1.dist-info/RECORD`

 * *Files 18% similar despite different names*

```diff
@@ -1,33 +1,35 @@
 h3sed/__init__.py,sha256=mgWnKo3Y6AQUI6FMaFYghlhhUEWw_8O4e-aF8bs1uvk,76
 h3sed/__main__.py,sha256=dLLEHzSyAMiFo7-zsAQhqzR2nvoiC23WKBBUCuuHl_4,94
-h3sed/conf.py,sha256=kdtftuyee5E6hMis8nVHxzmNSma8deP5NT3kuPpCtQI,7940
+h3sed/conf.py,sha256=z_7bFdssv5jZKI-gTp_zLmVby-wAHVxT_ASXMomN3QQ,7940
 h3sed/gui.py,sha256=SYTcBSjU5JoVBoDKDhKeJ9FCMWpEdAVb7rujxozCWac,74162
 h3sed/guibase.py,sha256=IOVEpjvBFrV6EkSCKfXQ65u8S1sfdn3--LPEpV16tVo,10876
 h3sed/images.py,sha256=CdloD0Pfpc0zDxfA8emcs-P4WgIeIlLD_YFCQQeOK7A,41483
-h3sed/main.py,sha256=R3Ns6kRhquSem_iiFdTuX7DltW8iQnUV_07D43bZCRM,5800
-h3sed/metadata.py,sha256=4ExcPl-o25CYSgbCQvYI_w241KEiWr79Wux3DoDDPZg,44338
-h3sed/templates.py,sha256=WLwBi-HUGTtCgbe48cX_mVU3lz_kFFptpfs1GOhnUZo,30068
+h3sed/main.py,sha256=DKIjbCKjgoyM7BnysqtQGv13lAQO7HbfzeF3zpjzAbc,5816
+h3sed/metadata.py,sha256=0Qdbw9tEH6-AmNbFMskd33WQV3H6tjaifcidvctITYM,45036
+h3sed/templates.py,sha256=v6-TuN_rQMldKcqdkZj9oaPZqd4IBgSUDyMFqY3ePLM,30207
 h3sed/etc/h3sed.ini,sha256=USxJ4rF4LSuXaDHj-oi4hepttWxDuTBe8c0vxnb4RLQ,255
 h3sed/lib/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 h3sed/lib/controls.py,sha256=QyA8nzeNCF7J4EfZZVYDJKJAt3HCLjZUGRR4mWizC84,23875
 h3sed/lib/util.py,sha256=37pvC24GqOH3wYL57qQExEn7RRGIOiyB_tjEgVfEqpg,14180
 h3sed/lib/wx_accel.py,sha256=hwsUKEj032eKAFSB6JyUhpgS_mnUZ7dY_96RwhKCDho,17561
 h3sed/lib/vendor/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 h3sed/lib/vendor/step.py,sha256=vRtgUQ7zuE0C_NpHhdIBV6g1lHi-4lZ1CvrvvBtrhxM,7920
 h3sed/plugins/__init__.py,sha256=Ilxpo7nx6sff6MO9nQ6HbZNVmZrJpi7hQu5B2RtD_xI,6309
 h3sed/plugins/hero/__init__.py,sha256=ES2yHerKTuv3jZOBkIVnI2CUWj1Hyx1rNHtFUdLl5L0,52400
 h3sed/plugins/hero/army.py,sha256=UczDty1EsIzOuBHJzID2EG56_lBhoSQ0fqEaAepSQLc,10248
-h3sed/plugins/hero/artifacts.py,sha256=VXe4DwY0QSnHG9aT4cHig1eCN9zvA1kkpUSl3qB-X6s,15707
-h3sed/plugins/hero/inventory.py,sha256=0gGlLxSHLWjr2NMrqVAaYa6D41dBsppKDhHrklmJhdI,6192
+h3sed/plugins/hero/artifacts.py,sha256=jAJMl9zY1MAP3AEsqtlZttyb7V20-wa0TFgq--8jz68,15880
+h3sed/plugins/hero/inventory.py,sha256=Ye35U4kdaRqAImSv0xGGlhpK8wbcuBiUuh7FSeY4Iqw,9358
 h3sed/plugins/hero/skills.py,sha256=0GvyygqN7ZhyEaAkOqVkoGyqf894XS7vy3Pms6TBiqs,7209
 h3sed/plugins/hero/spells.py,sha256=YzQ223ujDkipJ8UspUCzQ-k6Y41co9QoRdtQAb8bPxk,5709
 h3sed/plugins/hero/stats.py,sha256=GIS2ceBWo9_FbrM6qYvZ1yqi2j6-H4XY5MENwa7iinM,8411
-h3sed/plugins/version/__init__.py,sha256=gkvRwxgTnMAd_Dra6moZN1VoyNqqR3mIkPv8rKxMD3c,2227
-h3sed/plugins/version/hota.py,sha256=qzo9RPbhdbK45CjK7MP3xAuVXXFOVv4QlVpB_r89oGw,16315
-h3sed/plugins/version/sod.py,sha256=LfCYyNBCQJxH8pRr5HhJ6rk005sfBDX6kAg3qGUpSSs,6541
-h3sed-2.0.dist-info/LICENSE.md,sha256=8YjDZM6LRG87mXfw2KYhdbWHuR-wvwOGi4D1y9Qghm0,1100
-h3sed-2.0.dist-info/METADATA,sha256=DqUkIpQS9bZrNWrLZ-bWbMsbBI-V5ez5tGsCsQgqN60,4218
-h3sed-2.0.dist-info/WHEEL,sha256=a-zpFRIJzOq5QfuhBzbhiA1eHTzNCJn8OdRvhdNX0Rk,110
-h3sed-2.0.dist-info/entry_points.txt,sha256=bS7QP5bCbFdfTYsBx5xAUxc_FLVIEjYuduUbz-8TSn4,37
-h3sed-2.0.dist-info/top_level.txt,sha256=9IbalHA56Rhkznc6o4tVTefe9tS6jw8SMFy9gOrFJE4,6
-h3sed-2.0.dist-info/RECORD,,
+h3sed/plugins/version/__init__.py,sha256=SqX1U2akYSv1wmSFrbENkKtrbgQONHMGkxfGe4A_hJw,2213
+h3sed/plugins/version/ab.py,sha256=gS4YuNGcIXGwBwfmjTr0bau3NG977PxmzxxoxrnvsOU,6874
+h3sed/plugins/version/hota.py,sha256=WV_Ohsj3ysxUCKU30T09--STuCZISfh17KevJ_8U-1M,16403
+h3sed/plugins/version/roe.py,sha256=iTZCUDHsdx1NzVtz1M1JfNH55mZ9nM0eRNlrZgvP62Q,4206
+h3sed/plugins/version/sod.py,sha256=mzGXqhs5Eeh0uyW5Jcb4AJISg1c8tVdQ5L9QWsV0D8s,6623
+h3sed-2.1.dist-info/LICENSE.md,sha256=8YjDZM6LRG87mXfw2KYhdbWHuR-wvwOGi4D1y9Qghm0,1100
+h3sed-2.1.dist-info/METADATA,sha256=t9xmVZiQamuBDu19hmAmvCfw81D_i05nMoOz1QwWwAk,4264
+h3sed-2.1.dist-info/WHEEL,sha256=a-zpFRIJzOq5QfuhBzbhiA1eHTzNCJn8OdRvhdNX0Rk,110
+h3sed-2.1.dist-info/entry_points.txt,sha256=bS7QP5bCbFdfTYsBx5xAUxc_FLVIEjYuduUbz-8TSn4,37
+h3sed-2.1.dist-info/top_level.txt,sha256=9IbalHA56Rhkznc6o4tVTefe9tS6jw8SMFy9gOrFJE4,6
+h3sed-2.1.dist-info/RECORD,,
```

